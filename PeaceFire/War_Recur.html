<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>War Recurrence</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="War_Recur_files/libs/clipboard/clipboard.min.js"></script>
<script src="War_Recur_files/libs/quarto-html/quarto.js"></script>
<script src="War_Recur_files/libs/quarto-html/popper.min.js"></script>
<script src="War_Recur_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="War_Recur_files/libs/quarto-html/anchor.min.js"></script>
<link href="War_Recur_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="War_Recur_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="War_Recur_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="War_Recur_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="War_Recur_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">War Recurrence</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="libraries" class="level2">
<h2 class="anchored" data-anchor-id="libraries">Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("readxl")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyverse")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggplot2")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("survminer")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("timeROC")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("caret")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("timeROC")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("caret")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load necessary packages</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("randomForestSRC")</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("tidyr")</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("Synth")</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Synth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>##
## Synth Package: Implements Synthetic Control Methods.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>## See https://web.stanford.edu/~jhain/synthpage.html for additional information.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: prodlim</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: maditr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
To modify variables or add new variables:
             let(mtcars, new_var = 42, new_var2 = new_var*hp) %&gt;% head()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'maditr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    sort_by</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'tidyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:expss':

    contains, nest</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggplot2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:expss':

    vars</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:pec':

    R2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite as: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survival'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:caret':

    cluster</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggpubr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggpubr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:expss':

    compare_means</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'survminer'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    myeloma</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:expss':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(carData)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(carData)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(date)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:expss':

    compute, contains, na_if, recode, vars, where</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:maditr':

    between, coalesce, first, last</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ lubridate 1.9.3     ✔ stringr   1.5.1
✔ purrr     1.0.2     ✔ tibble    3.2.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::between()     masks maditr::between()
✖ dplyr::coalesce()    masks maditr::coalesce()
✖ readr::col_factor()  masks scales::col_factor()
✖ readr::cols()        masks maditr::cols()
✖ gridExtra::combine() masks dplyr::combine()
✖ dplyr::compute()     masks expss::compute()
✖ dplyr::contains()    masks tidyr::contains(), expss::contains()
✖ purrr::discard()     masks scales::discard()
✖ dplyr::filter()      masks stats::filter()
✖ dplyr::first()       masks maditr::first()
✖ stringr::fixed()     masks expss::fixed()
✖ purrr::keep()        masks expss::keep()
✖ dplyr::lag()         masks stats::lag()
✖ dplyr::last()        masks maditr::last()
✖ purrr::lift()        masks caret::lift()
✖ purrr::modify()      masks expss::modify()
✖ purrr::modify_if()   masks expss::modify_if()
✖ dplyr::na_if()       masks expss::na_if()
✖ tidyr::nest()        masks expss::nest()
✖ dplyr::recode()      masks car::recode(), expss::recode()
✖ stringr::regex()     masks expss::regex()
✖ purrr::some()        masks car::some()
✖ purrr::transpose()   masks maditr::transpose()
✖ dplyr::vars()        masks ggplot2::vars(), expss::vars()
✖ purrr::when()        masks expss::when()
✖ dplyr::where()       masks expss::where()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(carData)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(carData)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(date)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForestSRC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
 randomForestSRC 3.2.3 
 
 Type rfsrc.news() to see new features, changes, and bug fixes. 
 


Attaching package: 'randomForestSRC'

The following object is masked from 'package:purrr':

    partial</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pec)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(timeROC)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survivalROC)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForestSRC)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pec)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(timeROC)</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survivalROC)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-load-and-merge" class="level2">
<h2 class="anchored" data-anchor-id="data-load-and-merge">Data Load and Merge</h2>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>episodes <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"episodes.xlsx"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>polity_scaled<span class="ot">&lt;-</span> <span class="fu">scale</span>(episodes<span class="sc">$</span>p_polity2, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>gov_ter<span class="ot">&lt;-</span><span class="fu">ifelse</span>(episodes<span class="sc">$</span>wt<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>gov_war<span class="ot">&lt;-</span><span class="fu">ifelse</span>(episodes<span class="sc">$</span>wt<span class="sc">==</span><span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>ter_war<span class="ot">&lt;-</span><span class="fu">ifelse</span>(episodes<span class="sc">$</span>wt<span class="sc">==</span><span class="dv">3</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>coal<span class="ot">&lt;-</span> <span class="fu">scale</span>(episodes<span class="sc">$</span>W4, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>episodess <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, intensity_level <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>episodest<span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, type_of_conflict <span class="sc">==</span><span class="dv">3</span> )</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>peaces<span class="ot">&lt;-</span> episodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(peace<span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-merge--recycled" class="level3">
<h3 class="anchored" data-anchor-id="data-merge--recycled">Data merge- recycled</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># episodes_subset &lt;- select(episodes, conflict_id, outcome, recur_anyy, recur_side, ps, recur_notes, recur_zeigler, recur_any_zeigler, ps_note, end_year, cname, ccode, country_name, ccodealp, ccodecow, pko_u, pko, veto, cold_war, compally_au, major, cease_cf, time_to_recure, time_to_recurre, conflictep_id, conflictepisode, type_of_conflict2, dyadcount, confterm, recur_term, isq2015_id, time_recur, rebstrong, alliance_s, compally_b, noally_a, noally_b, ally_a, ally_b, compally_a, ter, start, end)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">#isq_subset &lt;- select(ISQ_ACD, year, isq2015_id, recur)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#qog_vars &lt;- c(</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Military and conflict-related variables</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># "wdi_armimp",         # Arms imports (SIPRI trend indicator values)</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"wvs_fight",          # Willingness to fight for country</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"wdi_expmil",         # Military expenditure (% of GDP)</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"wdi_expmilge",       # Military expenditure (% of general government expenditure)</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"bicc_hw",            # Heavy Weapons Index</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"bicc_gmi",           # Global Militarization Index</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"atop_ally",          # Member of an Alliance</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"atop_number",        # Number of Alliances</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"bicc_milexp",        # Military Expenditure Index</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"fe_etfra",           # Ethnic Fractionalization</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"year",        </span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"cname",           </span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Economic and political variables</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"al_ethnic2000",      # Ethnic fractionalization index, 2000</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"al_language2000",    # Language fractionalization index, 2000</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"al_religion2000",    # Religious fractionalization index, 2000</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"fe_cultdiv",         # Cultural diversity index</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"p_durable",          # Political durability</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"wdi_gdpcapcur",      # GDP per capita (current US$)</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"p_polity2"           # Revised polity score</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>qog_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># New variables added</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ht_colonial"</span>,        <span class="co"># Historical colonialism</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vdem_gender"</span>,        <span class="co"># Gender equality index</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gle_pop"</span>,            <span class="co"># Population data</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gle_gdp"</span>,            <span class="co"># GDP data</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fe_plural"</span>,          <span class="co"># Pluralism index</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vdem_exbribe"</span>,       <span class="co"># Executive bribes index</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vdem_execorr"</span>,       <span class="co"># Executive corruption index</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vdem_exembez"</span>,       <span class="co"># Executive embezzlement index</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vdem_jucorrdc"</span>,      <span class="co"># Judicial corruption index</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vdem_libdem"</span>,        <span class="co"># Liberal democracy index</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wdi_pop"</span>,            <span class="co"># Population data from World Development Indicators</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cname"</span>,              <span class="co"># Country name</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span>                <span class="co"># Year</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes&lt;-merge(episodes, selected_qog_vars,by=c("cname","year"), all.x= TRUE)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co">#eps&lt;-merge(episodes, NewWmeasure,by=c("country_name","year"), all.x= TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#epid&lt;-merge(episodes,tem_sean,by=c("conflict_id","end_year"), all=TRUE)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ACD_Sean_1000&lt;-merge(episodes_1000,ISQ_ACD,by=c("conflict_id","year"), all=TRUE)</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">#ACD_Sean_1000&lt;-merge(episodes_1000merge,ISQ_ACD_Merge,by=c("isq2015_id","year"), all=TRUE)</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">#ep_qog&lt;-merge(episodes,qog_std_ts_jan23,by=c("cname","year"))</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co">#ep&lt;-merge(copy,ep_qog,by=c("conflict_id","end_year"), all=TRUE)</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co">#clean_ep&lt;-ep[, sapply(ep, function(col) length(na.omit(col))) &gt;150]</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co">#dur_acd&lt;-merge(duration,ucdp_brd_dyadic_221 ,by=c("cname", "year"))</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co">#epidd$log_gdp&lt;-log(epidd$wdi_gdpcapcur)</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="co">#fromqog= subset(qog_std_ts_jan23, select =c(cname, year,fe_etfra) )</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="co">#epid&lt;-merge(episodes, fromqog,by=c("cname","year"))</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co">#epidd&lt;-merge(copy, epid,by=c("conflict_id","end_year"))</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$yearr&lt;- as.Date(episodes$start_date2)</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$yea&lt;-date.mdy(episodes$yearr)$yea</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$yea&lt;-episodes$yea+10</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$end&lt;- as.Date(episodes$ep_end_date)</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$en&lt;-date.mdy(episodes$end)$en</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$en&lt;-episodes$en+10</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a><span class="co">#X= subset(clean_o, select = -c(recur_a, conflict_id, end_year, cname, year, start_year, location,start_s,end_s,start,end, cumulative_intensity,    side_a, side_a_id, side_b,  side_b_id, incompatibility, type_of_conflict,   start_date, ep_end, gwno_a, region, conflictep_id, censordate,   durat, ccode, ccode_qog,cname_qog, ccodealp, ccodecow, version,    cname_year, ccodealp_year, time_to_recur, gwno_loc, peace_b, locac_b, cease_b, dis_b, rebvic_b, govvic_b, dyadcount, confterm) )</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Y=clean_o$recur_a</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a><span class="co">#clean_ep&lt;-ep[, sapply(ep, function(col) length(na.omit(col))) &gt;150]</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="co">#clean_o&lt;-na.omit(clean_ep)</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$peace&lt;-ifelse(episodes$outcome==1, 1,0)</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$cease&lt;-ifelse(episodes$outcome==2, 1,0)</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$govvic&lt;-ifelse(episodes$outcome==3, 1,0)</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$rebvic&lt;-ifelse(episodes$outcome==4, 1,0)</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$lowac&lt;-ifelse(episodes$outcome==5, 1,0)</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$dis&lt;-ifelse(episodes$outcome==6, 1,0)</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$lowcease&lt;-Recode(episodes$outcome, "1=0; 2=1; 3=0; 4=0; 5=1; 6=0")</span></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a><span class="co">#episodes$log_dur&lt;-log(episodes$duration)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="eda" class="level2">
<h2 class="anchored" data-anchor-id="eda">EDA</h2>
<section id="distribution-of-outcome" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-outcome">Distribution of Outcome</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>outs <span class="ot">&lt;-</span> <span class="fu">as.character</span>(episodes<span class="sc">$</span>outcome) <span class="co"># Convert factor to character if necessary</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a mapping for the outcomes</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>outcome_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Peace Agreement"</span>, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Ceasefire"</span>, </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Government Victory"</span>, </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Rebel Victory"</span>, </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"5"</span> <span class="ot">=</span> <span class="st">"Low Activity"</span>, </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"6"</span> <span class="ot">=</span> <span class="st">"Actors Ceases to Exist"</span>)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace the coded values with the corresponding labels</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>outs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(episodes<span class="sc">$</span>outs, <span class="cf">function</span>(x) outcome_labels[x])</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace NA values with "Ongoing Episodes"</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>outs[<span class="fu">is.na</span>(episodes<span class="sc">$</span>outs)] <span class="ot">&lt;-</span> <span class="st">"Ongoing Episodes"</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the 'outs' column back to factor and set the desired order</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>outs <span class="ot">&lt;-</span> <span class="fu">factor</span>(episodes<span class="sc">$</span>outs, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Peace Agreement"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Government Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Low Activity"</span>, <span class="st">"Actors Ceases to Exist"</span>, <span class="st">"Ongoing Episodes"</span>))</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar plot</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>outcome_freq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(episodes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(outs, outs, <span class="cf">function</span>(x) <span class="sc">-</span><span class="fu">length</span>(x)))) <span class="sc">+</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frequency of All Outcomes"</span>,</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Outcomes"</span>, </span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(outcome_freq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cross-tab-viz" class="level3">
<h3 class="anchored" data-anchor-id="cross-tab-viz">Cross-Tab Viz</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out rows with NA in the recurr column</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>episodes <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(recur_any))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 455 × 125
   episode_id cname       year cease outcome country_name conflict_id start_year
        &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;
 1          1 Bolivia (…  1947     0       4 Bolivia              200       1946
 2          2 Bolivia (…  1950     0       3 Bolivia              200       1949
 3          3 Bolivia (…  1953     0       4 Bolivia              200       1952
 4          4 Bolivia (…  1968     0       3 Bolivia              200       1967
 5          5 China       1950     0       4 China                202       1946
 6          6 Greece      1950     0       3 Greece               203       1946
 7          7 Iran (Isl…  1947     0       3 Iran                 205       1946
 8          8 Iran (Isl…  1969     0       5 Iran                 205       1966
 9          9 Iran (Isl…  1989     0       5 Iran                 205       1979
10         10 Iran (Isl…  1991     0       5 Iran                 205       1990
# ℹ 445 more rows
# ℹ 117 more variables: end_year &lt;dbl&gt;, peace_cease &lt;dbl&gt;,
#   peace_cease_notes &lt;chr&gt;, wdi_expmilge &lt;dbl&gt;, wdi_armimp &lt;dbl&gt;,
#   wdi_expmil &lt;dbl&gt;, bicc_hw &lt;dbl&gt;, bicc_gmi &lt;dbl&gt;, atop_ally &lt;dbl&gt;,
#   atop_number &lt;dbl&gt;, bicc_milexp &lt;dbl&gt;, fe_etfra &lt;dbl&gt;, al_ethnic2000 &lt;dbl&gt;,
#   al_language2000 &lt;dbl&gt;, al_religion2000 &lt;dbl&gt;, fe_cultdiv &lt;dbl&gt;,
#   p_durable &lt;dbl&gt;, wdi_gdpcapcur &lt;dbl&gt;, p_polity2 &lt;dbl&gt;, pko_u &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode the factor levels</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>recur0 <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(episodes<span class="sc">$</span>recur_any, <span class="st">'1'</span><span class="ot">=</span><span class="st">"Recurred"</span>, <span class="st">'0'</span><span class="ot">=</span><span class="st">"Non-recurred"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the bar chart</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(episodes, <span class="fu">aes</span>(<span class="at">x=</span>recur0)) <span class="sc">+</span> </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Distribution of War Recurrence Variable Based on ACD Conflict ID"</span>, </span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Recurrence Status"</span>, </span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out rows with NA in the recurr column</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>episodes <span class="ot">&lt;-</span> episodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(recur_side))</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode the factor levels</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>recur1 <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(episodes<span class="sc">$</span>recur_side, <span class="st">'1'</span><span class="ot">=</span><span class="st">"Recurred"</span>, <span class="st">'0'</span><span class="ot">=</span><span class="st">"Non-recurred"</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the bar chart</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(episodes, <span class="fu">aes</span>(<span class="at">x=</span>recur1)) <span class="sc">+</span> </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Distribution of War Recurrence Variable Based on Sufficient Linkage"</span>, </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Recurrence Status"</span>, </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>recur_outcome<span class="ot">&lt;-</span> <span class="fu">table</span>(episodes<span class="sc">$</span>recur0, episodes<span class="sc">$</span>outcome)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>recur_outcome_p<span class="ot">&lt;-</span> <span class="fu">prop.table</span>(recur_outcome, <span class="dv">1</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>recur_outcome_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(recur_outcome_p)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(recur_outcome_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"recur0"</span>, <span class="st">"outcome"</span>,  <span class="st">"Frequency"</span>)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>recur_outcome_df<span class="sc">$</span>outcome<span class="ot">&lt;-</span><span class="fu">recode_factor</span>(recur_outcome_df<span class="sc">$</span>outcome, <span class="st">'1'</span><span class="ot">=</span><span class="st">"Peace Agreements"</span>, <span class="st">'2'</span><span class="ot">=</span><span class="st">"Ceasefire"</span>, <span class="st">'3'</span><span class="ot">=</span><span class="st">"Gov Victory"</span>, <span class="st">'4'</span><span class="ot">=</span><span class="st">"Rebel Victory"</span>, <span class="st">'5'</span><span class="ot">=</span><span class="st">"Low Activity"</span>, <span class="st">'6'</span><span class="ot">=</span> <span class="st">"Other/Disappearance"</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>recur_by_outcome<span class="ot">&lt;-</span><span class="fu">ggplot</span>(recur_outcome_df, <span class="fu">aes</span>(<span class="at">x=</span>outcome, <span class="at">y=</span>Frequency, <span class="at">fill=</span>recur0)) <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>)<span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label=</span>percent) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"ACD Conflict ID-Based Recurrence By Termination Outcomes"</span>,</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption=</span><span class="st">""</span>,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle=</span><span class="st">""</span>,</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="st">"Outcomes"</span>, <span class="at">y=</span><span class="st">""</span>, <span class="at">fill=</span><span class="st">"Status"</span>)<span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>), <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>recur_by_outcome</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a frequency table</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>recur_outcome <span class="ot">&lt;-</span> <span class="fu">table</span>(episodes<span class="sc">$</span>recur1, episodes<span class="sc">$</span>outcome)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the table to a data frame for ggplot</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>recur_outcome_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(recur_outcome)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(recur_outcome_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"recur1"</span>, <span class="st">"outcome"</span>, <span class="st">"Frequency"</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode the outcome factor with descriptive names</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>recur_outcome_df<span class="sc">$</span>outcome <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(recur_outcome_df<span class="sc">$</span>outcome,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">'1'</span> <span class="ot">=</span> <span class="st">"Peace Agreements"</span>,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">'2'</span> <span class="ot">=</span> <span class="st">"Ceasefire"</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">'3'</span> <span class="ot">=</span> <span class="st">"Gov Victory"</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">'4'</span> <span class="ot">=</span> <span class="st">"Rebel Victory"</span>,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">'5'</span> <span class="ot">=</span> <span class="st">"Low Activity"</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">'6'</span> <span class="ot">=</span> <span class="st">"Other/Disappearance"</span>)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the bar chart using frequencies</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>recur_by_outcome <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur_outcome_df, <span class="fu">aes</span>(<span class="at">x =</span> outcome, <span class="at">y =</span> Frequency, <span class="at">fill =</span> recur1)) <span class="sc">+</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sufficient Linkage-Based Recurrence By Termination Outcomes"</span>,</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Outcomes"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>, <span class="at">fill =</span> <span class="st">"Status"</span>) <span class="sc">+</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>), <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>recur_by_outcome</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode the outcome variable for better readability</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>outcome_label <span class="ot">&lt;-</span> <span class="fu">recode_factor</span>(episodes<span class="sc">$</span>outcome,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'1'</span> <span class="ot">=</span> <span class="st">"Peace Agreements"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'2'</span> <span class="ot">=</span> <span class="st">"Ceasefire"</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'3'</span> <span class="ot">=</span> <span class="st">"Gov Victory"</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'4'</span> <span class="ot">=</span> <span class="st">"Rebel Victory"</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'5'</span> <span class="ot">=</span> <span class="st">"Low Activity"</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'6'</span> <span class="ot">=</span> <span class="st">"Other/Disappearance"</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart of the outcome variable separated by recur0</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>outcome_by_recur <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(episodes, <span class="fu">aes</span>(<span class="at">x=</span>outcome_label, <span class="at">fill=</span><span class="fu">factor</span>(recur0))) <span class="sc">+</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Outcomes by Recurrence Status"</span>,</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, </span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Frequency"</span>, </span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span><span class="st">"Recurrence Status"</span>) <span class="sc">+</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>)) <span class="sc">+</span> <span class="co"># Use manual colors if needed</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>outcome_by_recur</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-9-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cross-tab-viz1" class="level3">
<h3 class="anchored" data-anchor-id="cross-tab-viz1">Cross-Tab Viz1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>outcome_freq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(episodes, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of All Outcomes"</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>outcome_freq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart of the outcome variable without considering recur0</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>recur00_data<span class="ot">&lt;-</span><span class="fu">subset</span>(episodes, recur0 <span class="sc">==</span><span class="st">"Non-recurred"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>outcome_freq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur00_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes(Nonrecurred-ACD Conflict ID)"</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>outcome_freq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart of the outcome variable without considering recur0</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>recur01_data<span class="ot">&lt;-</span><span class="fu">subset</span>(episodes, recur0 <span class="sc">==</span><span class="st">"Recurred"</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>outcome_freq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur01_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes(Recurred-ACD Conflict ID)"</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, </span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>outcome_freq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart of the outcome variable without considering recur0</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>recur10_data<span class="ot">&lt;-</span><span class="fu">subset</span>(episodes, recur1 <span class="sc">==</span><span class="st">"Non-recurred"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>outcome_freq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur10_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes(Nonrecurred-Sufficient Linkage)"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>outcome_freq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar chart of the outcome variable without considering recur0</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>recur11_data<span class="ot">&lt;-</span><span class="fu">subset</span>(episodes, recur1 <span class="sc">==</span><span class="st">"Recurred"</span>)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>outcome_freq <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur11_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes(Recurred-Sufficient Linkage)"</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># Rotate x-axis labels for better readability</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>outcome_freq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the first plot (Non-recurred - ACD Conflict ID)</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>recur00_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, recur0 <span class="sc">==</span> <span class="st">"Non-recurred"</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>outcome_freq00 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur00_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes (Non-recurred - ACD Conflict ID)"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the second plot (Recurred - ACD Conflict ID)</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>recur01_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, recur0 <span class="sc">==</span> <span class="st">"Recurred"</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>outcome_freq01 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur01_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes (Recurred - ACD Conflict ID)"</span>,</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the third plot (Non-recurred - Sufficient Linkage)</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>recur10_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, recur1 <span class="sc">==</span> <span class="st">"Non-recurred"</span>)</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>outcome_freq10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur10_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes (Non-recurred - Sufficient Linkage)"</span>,</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the fourth plot (Recurred - Sufficient Linkage)</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>recur11_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, recur1 <span class="sc">==</span> <span class="st">"Recurred"</span>)</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>outcome_freq11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur11_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes (Recurred - Sufficient Linkage)"</span>,</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all four plots into one</span></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(outcome_freq00, outcome_freq01, outcome_freq10, outcome_freq11, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-10-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TableGrob (2 x 2) "arrange": 4 grobs
  z     cells    name           grob
1 1 (1-1,1-1) arrange gtable[layout]
2 2 (1-1,2-2) arrange gtable[layout]
3 3 (2-2,1-1) arrange gtable[layout]
4 4 (2-2,2-2) arrange gtable[layout]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the maximum frequency across all subsets</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>max_freq <span class="ot">&lt;-</span> <span class="fu">max</span>(</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(episodes<span class="sc">$</span>recur0, episodes<span class="sc">$</span>outcome),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(episodes<span class="sc">$</span>recur1, episodes<span class="sc">$</span>outcome)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the first plot (Non-recurred - ACD Conflict ID)</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>recur00_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, recur0 <span class="sc">==</span> <span class="st">"Non-recurred"</span>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>outcome_freq00 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur00_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes (Non-recurred - ACD Conflict ID)"</span>,</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, max_freq))</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the second plot (Recurred - ACD Conflict ID)</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>recur01_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, recur0 <span class="sc">==</span> <span class="st">"Recurred"</span>)</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>outcome_freq01 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur01_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes (Recurred - ACD Conflict ID)"</span>,</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, max_freq))</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the third plot (Non-recurred - Sufficient Linkage)</span></span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>recur10_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, recur1 <span class="sc">==</span> <span class="st">"Non-recurred"</span>)</span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>outcome_freq10 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur10_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes (Non-recurred - Sufficient Linkage)"</span>,</span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, max_freq))</span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the fourth plot (Recurred - Sufficient Linkage)</span></span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a>recur11_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, recur1 <span class="sc">==</span> <span class="st">"Recurred"</span>)</span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a>outcome_freq11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(recur11_data, <span class="fu">aes</span>(<span class="at">x=</span>outcome)) <span class="sc">+</span></span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Frequency of Outcomes (Recurred - Sufficient Linkage)"</span>,</span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Outcomes"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>, max_freq))</span>
<span id="cb76-50"><a href="#cb76-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-51"><a href="#cb76-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all four plots into one</span></span>
<span id="cb76-52"><a href="#cb76-52" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> <span class="fu">grid.arrange</span>(outcome_freq00, outcome_freq01, outcome_freq10, outcome_freq11, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-10-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>TableGrob (2 x 2) "arrange": 4 grobs
  z     cells    name           grob
1 1 (1-1,1-1) arrange gtable[layout]
2 2 (1-1,2-2) arrange gtable[layout]
3 3 (2-2,1-1) arrange gtable[layout]
4 4 (2-2,2-2) arrange gtable[layout]</code></pre>
</div>
</div>
</section>
</section>
<section id="kaplan-meier-survival-curves" class="level2">
<h2 class="anchored" data-anchor-id="kaplan-meier-survival-curves">Kaplan-Meier survival curves</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new dataframe from episodes</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>new_episodes <span class="ot">&lt;-</span> episodes</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="ot">&lt;-</span>new_episodes[, <span class="fu">c</span>(<span class="st">"outcome"</span>, <span class="st">"recur_side"</span>, <span class="st">"recur_any"</span>, <span class="st">"time_to_recur"</span>, <span class="st">"time_to_recur_any"</span>)]</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="ot">&lt;-</span><span class="fu">na.omit</span>(new_episodes)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert the numerical outcome variable to a factor with appropriate labels</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="sc">$</span>outcome <span class="ot">&lt;-</span> <span class="fu">factor</span>(new_episodes<span class="sc">$</span>outcome, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>),</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Peace Agreement"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Gov Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Low Activity"</span>, <span class="st">"Actor Ceases"</span>))</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new variables for time in years</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="sc">$</span>time_to_recur_any_years <span class="ot">&lt;-</span> new_episodes<span class="sc">$</span>time_to_recur_any <span class="sc">/</span> <span class="fl">365.25</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="sc">$</span>time_to_recur_years <span class="ot">&lt;-</span> new_episodes<span class="sc">$</span>time_to_recur <span class="sc">/</span> <span class="fl">365.25</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Trim follow-up time to 20,000 days (approximately 54.8 years), and create corresponding variables in years</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="sc">$</span>time_to_recur_any_years <span class="ot">&lt;-</span> <span class="fu">pmin</span>(new_episodes<span class="sc">$</span>time_to_recur_any_years, <span class="dv">20000</span> <span class="sc">/</span> <span class="fl">365.25</span>)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="sc">$</span>time_to_recur_years <span class="ot">&lt;-</span> <span class="fu">pmin</span>(new_episodes<span class="sc">$</span>time_to_recur_years, <span class="dv">20000</span> <span class="sc">/</span> <span class="fl">365.25</span>)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the Kaplan-Meier survival curves for first plot (Any Recurrence)</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>km_fit_outcome_any <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time_to_recur_any_years, recur_any) <span class="sc">~</span> outcome, <span class="at">data =</span> new_episodes)</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Kaplan-Meier survival curves with percentages in the risk table (Any Recurrence)</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>km_plot_any <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(km_fit_outcome_any, <span class="at">data =</span> new_episodes,</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">pval =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">FALSE</span>,</span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>                          <span class="at">risk.table =</span> <span class="cn">TRUE</span>, <span class="at">risk.table.col =</span> <span class="st">"strata"</span>,</span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>                          <span class="at">risk.table.y.text.col =</span> <span class="cn">TRUE</span>, </span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">risk.table.height =</span> <span class="fl">0.25</span>,</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">risk.table.title =</span> <span class="st">"Number at Risk"</span>,</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">35</span>),  <span class="co"># Limit x-axis to 35 years</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">break.time.by =</span> <span class="dv">5</span>,  <span class="co"># Break x-axis every 5 years</span></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>() <span class="sc">+</span>  <span class="co"># Use classic theme</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.5</span>),  <span class="co"># Add major grid lines</span></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"lightgray"</span>, <span class="at">size =</span> <span class="fl">0.25</span>)),  <span class="co"># Add minor grid lines</span></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>                          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"orange"</span>, <span class="st">"brown"</span>),</span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"KM Survival Curves for Outcomes (Any Recurrence)"</span>,</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">"Time (Years)"</span>, <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>,</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>                          <span class="at">tables.theme =</span> <span class="fu">theme_classic</span>())  <span class="co"># Use classic theme for the risk table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.
ℹ Please use the `linewidth` argument instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the Kaplan-Meier survival curves for the second plot (Side Recurrence)</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>km_fit_outcome_side <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time_to_recur_years, recur_side) <span class="sc">~</span> outcome, <span class="at">data =</span> new_episodes)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Kaplan-Meier survival curves with percentages in the risk table for the second plot (Side Recurrence)</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>km_plot_side <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(km_fit_outcome_side, <span class="at">data =</span> new_episodes,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pval =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">FALSE</span>,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">risk.table =</span> <span class="cn">TRUE</span>, <span class="at">risk.table.col =</span> <span class="st">"strata"</span>,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">risk.table.y.text.col =</span> <span class="cn">TRUE</span>, </span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">risk.table.height =</span> <span class="fl">0.25</span>,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">risk.table.title =</span> <span class="st">"Number at Risk"</span>,</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">35</span>),  <span class="co"># Limit x-axis to 35 years</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">break.time.by =</span> <span class="dv">5</span>,  <span class="co"># Break x-axis every 5 years</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>() <span class="sc">+</span>  <span class="co"># Use classic theme</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.5</span>),  <span class="co"># Add major grid lines</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"lightgray"</span>, <span class="at">size =</span> <span class="fl">0.25</span>)),  <span class="co"># Add minor grid lines</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"orange"</span>, <span class="st">"brown"</span>),</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">title =</span> <span class="st">"KM Survival Curves for Outcomes (Side Recurrence)"</span>,</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">xlab =</span> <span class="st">"Time (Years)"</span>, <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>,</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">tables.theme =</span> <span class="fu">theme_classic</span>())  <span class="co"># Use classic theme for the risk table</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print plots</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(km_plot_any)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(km_plot_side)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cox-models" class="level2">
<h2 class="anchored" data-anchor-id="cox-models">Cox Models</h2>
<section id="cox-p-models" class="level3">
<h3 class="anchored" data-anchor-id="cox-p-models">Cox P Models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any) <span class="sc">~</span>dis<span class="sc">+</span>cease<span class="sc">+</span>govvic<span class="sc">+</span>rebvic<span class="sc">+</span>lowac, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>m2<span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any)<span class="sc">~</span>dis<span class="sc">+</span>cease<span class="sc">+</span>govvic<span class="sc">+</span>rebvic<span class="sc">+</span>lowac<span class="sc">+</span>pko_u<span class="sc">+</span>log_dur<span class="sc">+</span>cold_war<span class="sc">+</span>log_gdp<span class="sc">+</span>veto_u<span class="sc">+</span>ter_war<span class="sc">+</span>gov_war<span class="sc">+</span>p_polity2<span class="sc">+</span>fe_etfra<span class="sc">+</span>log_pop<span class="sc">+</span>al_religion2000<span class="sc">+</span>fe_cultdiv<span class="sc">+</span>W4<span class="sc">+</span>ps_original, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>m3<span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur, recur_side) <span class="sc">~</span>dis<span class="sc">+</span>cease<span class="sc">+</span>govvic<span class="sc">+</span>rebvic<span class="sc">+</span>lowac, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>m4<span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur, recur_side)<span class="sc">~</span>dis<span class="sc">+</span>cease<span class="sc">+</span>govvic<span class="sc">+</span>rebvic<span class="sc">+</span>lowac<span class="sc">+</span>pko_u<span class="sc">+</span>log_dur<span class="sc">+</span>cold_war<span class="sc">+</span>log_gdp<span class="sc">+</span>veto_u<span class="sc">+</span>ter_war<span class="sc">+</span>gov_war<span class="sc">+</span>p_polity2<span class="sc">+</span>fe_etfra<span class="sc">+</span>log_pop<span class="sc">++</span>al_religion2000<span class="sc">+</span>fe_cultdiv<span class="sc">+</span>W4<span class="sc">+</span>ps_original, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co">#stargazer(m1, m2, m3, m4, type = "text")</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(m1, m2, m3, m4,</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">ord.intercepts =</span> <span class="cn">TRUE</span>,</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">dep.var.labels =</span> <span class="fu">c</span>(<span class="st">"UCDP ID-Based War Recurrence"</span>, <span class="st">"UCDP ID-Based War Recurrence"</span>, <span class="st">"Linkage-Based War Recurrence"</span>, <span class="st">"Linkage-Based War Recurrence"</span>),</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">covariate.labels =</span> <span class="fu">c</span>(<span class="st">"Actor Ceases"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Government Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Low Activity"</span>, <span class="st">"Peacekeeping Missions"</span>, <span class="st">"Log(Duration)"</span>, <span class="st">"Cold War"</span>, <span class="st">"Log(GDP per Capita)"</span>, <span class="st">"Number of Veto Players"</span>, <span class="st">"War over Government"</span>, <span class="st">"War over Territory"</span>, <span class="st">"Polity Score"</span>, <span class="st">"Ethnic Fractionalization"</span>, <span class="st">"Coalition Size"</span>, <span class="st">"Log(Population)"</span>, <span class="st">"Language Fractionalization"</span>, <span class="st">"Power-Sharing"</span>, <span class="st">"Religion Fractionalization"</span>, <span class="st">"Cultural Diversity"</span>), <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==========================================================================================================
                                                         Dependent variable:                              
                           -------------------------------------------------------------------------------
                                UCDP ID-Based War Recurrence            UCDP ID-Based War Recurrence      
                                  (1)                 (2)                 (3)                 (4)         
----------------------------------------------------------------------------------------------------------
Actor Ceases                     -0.484              0.169               -0.447              -0.131       
                                (0.459)             (0.606)             (0.503)             (0.683)       
                                                                                                          
Ceasefire                       0.603**             1.182***            0.658**             0.861**       
                                (0.263)             (0.366)             (0.284)             (0.381)       
                                                                                                          
Government Victory               -0.184              0.283              -0.757**             -0.493       
                                (0.252)             (0.377)             (0.308)             (0.449)       
                                                                                                          
Rebel Victory                    0.105               0.822              -0.894**             -0.319       
                                (0.295)             (0.444)             (0.422)             (0.597)       
                                                                                                          
Low Activity                    0.783***            1.186***            0.884***            1.038***      
                                (0.226)             (0.335)             (0.246)             (0.359)       
                                                                                                          
Peacekeeping Missions                               -0.585**                                 -0.454       
                                                    (0.282)                                 (0.315)       
                                                                                                          
Log(Duration)                                        0.059*                                  -0.008       
                                                    (0.029)                                 (0.032)       
                                                                                                          
Cold War                                           -0.492***                               -0.836***      
                                                    (0.175)                                 (0.211)       
                                                                                                          
Log(GDP per Capita)                                  -0.080                                  -0.093       
                                                    (0.057)                                 (0.065)       
                                                                                                          
Number of Veto Players                              0.236***                                0.173**       
                                                    (0.088)                                 (0.093)       
                                                                                                          
War over Government                                -1.431***                               -1.842***      
                                                    (1.029)                                 (1.043)       
                                                                                                          
War over Territory                                 -1.321***                               -2.205***      
                                                    (1.031)                                 (1.048)       
                                                                                                          
Polity Score                                         -0.015                                  -0.040       
                                                    (0.022)                                 (0.025)       
                                                                                                          
Ethnic Fractionalization                            1.508**                                  1.382*       
                                                    (0.628)                                 (0.670)       
                                                                                                          
Coalition Size                                       0.028                                   -0.056       
                                                    (0.055)                                 (0.062)       
                                                                                                          
Log(Population)                                      -0.106                                  -0.192       
                                                    (0.365)                                 (0.399)       
                                                                                                          
Language Fractionalization                           -1.130                                  -0.866       
                                                    (0.669)                                 (0.735)       
                                                                                                          
Power-Sharing                                        -0.192                                  0.960        
                                                    (0.686)                                 (0.790)       
                                                                                                          
Religion Fractionalization                           0.190                                   0.098        
                                                    (0.247)                                 (0.276)       
                                                                                                          
----------------------------------------------------------------------------------------------------------
Observations                      455                 329                 455                 329         
R2                               0.107               0.209               0.197               0.297        
Max. Possible R2                 0.999               0.999               0.996               0.997        
Log Likelihood                 -1,550.938          -1,114.252          -1,219.034           -883.154      
Wald Test                  48.250*** (df = 5) 264.530*** (df = 19) 94.070*** (df = 5) 310.540*** (df = 19)
LR Test                    51.640*** (df = 5) 76.996*** (df = 19)  99.780*** (df = 5) 115.992*** (df = 19)
Score (Logrank) Test       51.438*** (df = 5) 78.548*** (df = 19)  95.665*** (df = 5) 118.773*** (df = 19)
==========================================================================================================
Note:                                                                          *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#al_language2000</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co">#al_religion2000</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fe_etfra</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">#fe_cultdiv</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">#al_ethnic2000</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Check proportional hazards assumption</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>m1_t<span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(m1)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>m2_t<span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(m2)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>m3_t<span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(m3)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>m4_t<span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(m4)</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m1_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         chisq df       p
dis     0.0994  1 0.75260
cease   1.1805  1 0.27725
govvic 10.9580  1 0.00093
rebvic  1.1021  1 0.29381
lowac   6.0333  1 0.01404
GLOBAL 14.2584  5 0.01405</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m2_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     chisq df     p
dis              0.0444332  1 0.833
cease            0.1483013  1 0.700
govvic           3.5989805  1 0.058
rebvic           0.0005874  1 0.981
lowac            0.8331863  1 0.361
pko_u            1.2850393  1 0.257
log_dur          5.4597689  1 0.019
cold_war         0.0324631  1 0.857
log_gdp          2.7998279  1 0.094
veto_u           1.6101650  1 0.204
ter_war          0.0000616  1 0.994
gov_war          0.0010633  1 0.974
p_polity2        4.4359281  1 0.035
fe_etfra         0.0239740  1 0.877
log_pop          0.0839223  1 0.772
al_religion2000  0.0111114  1 0.916
fe_cultdiv       1.2799303  1 0.258
W4               2.7115601  1 0.100
ps_original      3.4820684  1 0.062
GLOBAL          23.3819547 19 0.221</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m3_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       chisq df     p
dis    2.125  1 0.145
cease  3.704  1 0.054
govvic 0.645  1 0.422
rebvic 0.602  1 0.438
lowac  4.589  1 0.032
GLOBAL 8.251  5 0.143</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(m4_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      chisq df          p
dis              2.69519262  1     0.1007
cease            4.56012230  1     0.0327
govvic           0.22149714  1     0.6379
rebvic           3.51213317  1     0.0609
lowac            2.44894340  1     0.1176
pko_u            0.01881588  1     0.8909
log_dur         25.99137111  1 0.00000034
cold_war         6.78720120  1     0.0092
log_gdp          0.04147132  1     0.8386
veto_u           5.16563745  1     0.0230
ter_war          0.79338533  1     0.3731
gov_war          0.84177544  1     0.3589
p_polity2        0.00027204  1     0.9868
fe_etfra         0.00000377  1     0.9985
log_pop          0.84916823  1     0.3568
al_religion2000  0.05014842  1     0.8228
fe_cultdiv       0.05344662  1     0.8172
W4               0.16978739  1     0.6803
ps_original      0.05276456  1     0.8183
GLOBAL          42.42831304 19     0.0016</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#vif(m1)</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co">#vif(m2)</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co">#vif(m3)</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co">#vif(m4)</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>columns_of_interest <span class="ot">&lt;-</span> episodes[, <span class="fu">c</span>(<span class="st">"al_language2000"</span>, <span class="st">"al_religion2000"</span>, <span class="st">"fe_etfra"</span>, <span class="st">"fe_cultdiv"</span>)]</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(columns_of_interest, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                al_language2000 al_religion2000  fe_etfra fe_cultdiv
al_language2000       1.0000000       0.2920441 0.7176872  0.7396354
al_religion2000       0.2920441       1.0000000 0.3563721  0.1479685
fe_etfra              0.7176872       0.3563721 1.0000000  0.7723940
fe_cultdiv            0.7396354       0.1479685 0.7723940  1.0000000</code></pre>
</div>
</div>
</section>
<section id="coefficent-plots-from-cox" class="level3">
<h3 class="anchored" data-anchor-id="coefficent-plots-from-cox">Coefficent Plots from Cox</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting model coefficients and robust standard errors from the summary</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>coef_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(m2)<span class="sc">$</span>coefficients</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename terms for better readability</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>terms_rename <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dis"</span> <span class="ot">=</span> <span class="st">"Actor Ceases"</span>,</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cease"</span> <span class="ot">=</span> <span class="st">"Ceasefire"</span>,</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"govvic"</span> <span class="ot">=</span> <span class="st">"Government Victory"</span>,</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rebvic"</span> <span class="ot">=</span> <span class="st">"Rebel Victory"</span>,</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lowac"</span> <span class="ot">=</span> <span class="st">"Low Activity"</span>,</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pko_u"</span> <span class="ot">=</span> <span class="st">"Peacekeeping Missions"</span>,</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log_dur"</span> <span class="ot">=</span> <span class="st">"Log(Duration)"</span>,</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cold_war"</span> <span class="ot">=</span> <span class="st">"Cold War"</span>,</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log_gdp"</span> <span class="ot">=</span> <span class="st">"Log(GDP per Capita)"</span>,</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"veto_u"</span> <span class="ot">=</span> <span class="st">"Number of Veto Players"</span>,</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gov_war"</span> <span class="ot">=</span> <span class="st">"War over Government"</span>,</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ter_war"</span> <span class="ot">=</span> <span class="st">"War over Territory"</span>,</span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p_polity2"</span> <span class="ot">=</span> <span class="st">"Polity Score"</span>,</span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fe_etfra"</span> <span class="ot">=</span> <span class="st">"Ethnic Fractionalization"</span>,</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W4"</span> <span class="ot">=</span> <span class="st">"Coalition Size"</span>,</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log_pop"</span> <span class="ot">=</span> <span class="st">"Log(Population)"</span>,</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ps_original"</span> <span class="ot">=</span> <span class="st">"Power-Sharing"</span>,</span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"al_religion2000"</span> <span class="ot">=</span> <span class="st">"Religion Fractionalization"</span>,</span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fe_cultdiv"</span> <span class="ot">=</span> <span class="st">"Cultural Diversity"</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for plotting</span></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>df_coef <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coef_summary),</span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coef_summary[, <span class="st">"coef"</span>],</span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdErr =</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> coef_summary[, <span class="st">"coef"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> coef_summary[, <span class="st">"coef"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> coef_summary[, <span class="st">"Pr(&gt;|z|)"</span>]</span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-36"><a href="#cb97-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-37"><a href="#cb97-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the renaming to the Term column</span></span>
<span id="cb97-38"><a href="#cb97-38" aria-hidden="true" tabindex="-1"></a>df_coef<span class="sc">$</span>Term <span class="ot">&lt;-</span> terms_rename[df_coef<span class="sc">$</span>Term]</span>
<span id="cb97-39"><a href="#cb97-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-40"><a href="#cb97-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by Estimate from most negative to most positive</span></span>
<span id="cb97-41"><a href="#cb97-41" aria-hidden="true" tabindex="-1"></a>df_coef <span class="ot">&lt;-</span> df_coef[<span class="fu">order</span>(df_coef<span class="sc">$</span>Estimate), ]</span>
<span id="cb97-42"><a href="#cb97-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-43"><a href="#cb97-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting using ggplot2</span></span>
<span id="cb97-44"><a href="#cb97-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb97-45"><a href="#cb97-45" aria-hidden="true" tabindex="-1"></a>coef_ucdp<span class="ot">&lt;-</span><span class="fu">ggplot</span>(df_coef, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> <span class="fu">reorder</span>(Term, Estimate))) <span class="sc">+</span></span>
<span id="cb97-46"><a href="#cb97-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-47"><a href="#cb97-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower, <span class="at">xmax =</span> Upper), <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="fu">ifelse</span>(df_coef<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"blue"</span>, <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb97-48"><a href="#cb97-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb97-49"><a href="#cb97-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Coefficient Plot of Cox Model:UCDP"</span>,</span>
<span id="cb97-50"><a href="#cb97-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Coefficient Value"</span>,</span>
<span id="cb97-51"><a href="#cb97-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variables"</span>)</span>
<span id="cb97-52"><a href="#cb97-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-53"><a href="#cb97-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-54"><a href="#cb97-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting model coefficients and robust standard errors from the summary</span></span>
<span id="cb97-55"><a href="#cb97-55" aria-hidden="true" tabindex="-1"></a>coef_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(m4)<span class="sc">$</span>coefficients</span>
<span id="cb97-56"><a href="#cb97-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-57"><a href="#cb97-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename terms for better readability</span></span>
<span id="cb97-58"><a href="#cb97-58" aria-hidden="true" tabindex="-1"></a>terms_rename <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb97-59"><a href="#cb97-59" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dis"</span> <span class="ot">=</span> <span class="st">"Actor Ceases"</span>,</span>
<span id="cb97-60"><a href="#cb97-60" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cease"</span> <span class="ot">=</span> <span class="st">"Ceasefire"</span>,</span>
<span id="cb97-61"><a href="#cb97-61" aria-hidden="true" tabindex="-1"></a>  <span class="st">"govvic"</span> <span class="ot">=</span> <span class="st">"Government Victory"</span>,</span>
<span id="cb97-62"><a href="#cb97-62" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rebvic"</span> <span class="ot">=</span> <span class="st">"Rebel Victory"</span>,</span>
<span id="cb97-63"><a href="#cb97-63" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lowac"</span> <span class="ot">=</span> <span class="st">"Low Activity"</span>,</span>
<span id="cb97-64"><a href="#cb97-64" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pko_u"</span> <span class="ot">=</span> <span class="st">"Peacekeeping Missions"</span>,</span>
<span id="cb97-65"><a href="#cb97-65" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log_dur"</span> <span class="ot">=</span> <span class="st">"Log(Duration)"</span>,</span>
<span id="cb97-66"><a href="#cb97-66" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cold_war"</span> <span class="ot">=</span> <span class="st">"Cold War"</span>,</span>
<span id="cb97-67"><a href="#cb97-67" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log_gdp"</span> <span class="ot">=</span> <span class="st">"Log(GDP per Capita)"</span>,</span>
<span id="cb97-68"><a href="#cb97-68" aria-hidden="true" tabindex="-1"></a>  <span class="st">"veto_u"</span> <span class="ot">=</span> <span class="st">"Number of Veto Players"</span>,</span>
<span id="cb97-69"><a href="#cb97-69" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gov_war"</span> <span class="ot">=</span> <span class="st">"War over Government"</span>,</span>
<span id="cb97-70"><a href="#cb97-70" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ter_war"</span> <span class="ot">=</span> <span class="st">"War over Territory"</span>,</span>
<span id="cb97-71"><a href="#cb97-71" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p_polity2"</span> <span class="ot">=</span> <span class="st">"Polity Score"</span>,</span>
<span id="cb97-72"><a href="#cb97-72" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fe_etfra"</span> <span class="ot">=</span> <span class="st">"Ethnic Fractionalization"</span>,</span>
<span id="cb97-73"><a href="#cb97-73" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W4"</span> <span class="ot">=</span> <span class="st">"Coalition Size"</span>,</span>
<span id="cb97-74"><a href="#cb97-74" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log_pop"</span> <span class="ot">=</span> <span class="st">"Log(Population)"</span>,</span>
<span id="cb97-75"><a href="#cb97-75" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ps_original"</span> <span class="ot">=</span> <span class="st">"Power-Sharing"</span>,</span>
<span id="cb97-76"><a href="#cb97-76" aria-hidden="true" tabindex="-1"></a>  <span class="st">"al_religion2000"</span> <span class="ot">=</span> <span class="st">"Religion Fractionalization"</span>,</span>
<span id="cb97-77"><a href="#cb97-77" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fe_cultdiv"</span> <span class="ot">=</span> <span class="st">"Cultural Diversity"</span></span>
<span id="cb97-78"><a href="#cb97-78" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-79"><a href="#cb97-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-80"><a href="#cb97-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for plotting</span></span>
<span id="cb97-81"><a href="#cb97-81" aria-hidden="true" tabindex="-1"></a>df_coef <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb97-82"><a href="#cb97-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coef_summary),</span>
<span id="cb97-83"><a href="#cb97-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coef_summary[, <span class="st">"coef"</span>],</span>
<span id="cb97-84"><a href="#cb97-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdErr =</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb97-85"><a href="#cb97-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> coef_summary[, <span class="st">"coef"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb97-86"><a href="#cb97-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> coef_summary[, <span class="st">"coef"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb97-87"><a href="#cb97-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> coef_summary[, <span class="st">"Pr(&gt;|z|)"</span>]</span>
<span id="cb97-88"><a href="#cb97-88" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-89"><a href="#cb97-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-90"><a href="#cb97-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply renaming to the Term column</span></span>
<span id="cb97-91"><a href="#cb97-91" aria-hidden="true" tabindex="-1"></a>df_coef<span class="sc">$</span>Term <span class="ot">&lt;-</span> terms_rename[df_coef<span class="sc">$</span>Term]</span>
<span id="cb97-92"><a href="#cb97-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-93"><a href="#cb97-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by Estimate from most negative to most positive</span></span>
<span id="cb97-94"><a href="#cb97-94" aria-hidden="true" tabindex="-1"></a>df_coef <span class="ot">&lt;-</span> df_coef[<span class="fu">order</span>(df_coef<span class="sc">$</span>Estimate), ]</span>
<span id="cb97-95"><a href="#cb97-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-96"><a href="#cb97-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting using ggplot2</span></span>
<span id="cb97-97"><a href="#cb97-97" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb97-98"><a href="#cb97-98" aria-hidden="true" tabindex="-1"></a>coef_link<span class="ot">&lt;-</span><span class="fu">ggplot</span>(df_coef, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> <span class="fu">reorder</span>(Term, Estimate))) <span class="sc">+</span></span>
<span id="cb97-99"><a href="#cb97-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-100"><a href="#cb97-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower, <span class="at">xmax =</span> Upper), <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="fu">ifelse</span>(df_coef<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"blue"</span>, <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb97-101"><a href="#cb97-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb97-102"><a href="#cb97-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Coefficient Plot of Cox Model:Link"</span>,</span>
<span id="cb97-103"><a href="#cb97-103" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Coefficient Value"</span>,</span>
<span id="cb97-104"><a href="#cb97-104" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variables"</span>)</span>
<span id="cb97-105"><a href="#cb97-105" aria-hidden="true" tabindex="-1"></a>coef_ucdp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>coef_link</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="survival-rates-from-cox" class="level3">
<h3 class="anchored" data-anchor-id="survival-rates-from-cox">Survival Rates from Cox</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define factor levels and labels</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>outcome_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Peace Agreement"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Gov Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Low Activity"</span>, <span class="st">"Actor Ceases"</span>)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert outcome variable to factor with specified levels in the original dataset</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>outcomes <span class="ot">&lt;-</span> <span class="fu">factor</span>(episodes<span class="sc">$</span>outcome, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">labels =</span> outcome_levels)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the time variables from days to years in the original dataset</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>time_to_recur_any_years <span class="ot">&lt;-</span> episodes<span class="sc">$</span>time_to_recur_any <span class="sc">/</span> <span class="fl">365.25</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>time_to_recur_years <span class="ot">&lt;-</span> episodes<span class="sc">$</span>time_to_recur <span class="sc">/</span> <span class="fl">365.25</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit Cox proportional hazards models with time in years</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur_any_years, recur_any) <span class="sc">~</span> <span class="fu">as.factor</span>(outcomes) <span class="sc">+</span> pko_u <span class="sc">+</span> log_dur <span class="sc">+</span> cold_war <span class="sc">+</span> log_gdp <span class="sc">+</span> veto_u <span class="sc">+</span> gov_war <span class="sc">+</span> ter_war <span class="sc">+</span> p_polity2 <span class="sc">+</span> fe_etfra <span class="sc">+</span> W4 <span class="sc">+</span> log_pop <span class="sc">+</span> ps_original <span class="sc">+</span> al_religion2000, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur_years, recur_side) <span class="sc">~</span> <span class="fu">as.factor</span>(outcomes) <span class="sc">+</span> pko_u <span class="sc">+</span> log_dur <span class="sc">+</span> cold_war <span class="sc">+</span> log_gdp <span class="sc">+</span> veto_u <span class="sc">+</span> gov_war <span class="sc">+</span> ter_war <span class="sc">+</span> p_polity2 <span class="sc">+</span> fe_etfra <span class="sc">+</span> W4 <span class="sc">+</span> log_pop <span class="sc">+</span> ps_original <span class="sc">+</span> al_religion2000, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create representative data without al_language2000</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>representative_data <span class="ot">&lt;-</span> episodes <span class="sc">%&gt;%</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">pko_u =</span> <span class="fu">median</span>(<span class="fu">as.numeric</span>(pko_u), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_dur =</span> <span class="fu">mean</span>(log_dur, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">cold_war =</span> <span class="fu">median</span>(cold_war, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_gdp =</span> <span class="fu">mean</span>(log_gdp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">veto_u =</span> <span class="fu">median</span>(veto_u, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">gov_war =</span> <span class="fu">median</span>(gov_war, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">ter_war =</span> <span class="fu">median</span>(ter_war, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_polity2 =</span> <span class="fu">mean</span>(p_polity2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fe_etfra =</span> <span class="fu">mean</span>(fe_etfra, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">W4 =</span> <span class="fu">mean</span>(W4, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_pop =</span> <span class="fu">mean</span>(log_pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">ps_original =</span> <span class="fu">median</span>(ps_original, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">al_religion2000 =</span> <span class="fu">mean</span>(al_religion2000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">fe_cultdiv =</span> <span class="fu">mean</span>(fe_cultdiv, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Expand the data to include different outcomes</span></span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>expanded_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">replicate</span>(<span class="dv">6</span>, representative_data, <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>expanded_data<span class="sc">$</span>outcomes <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(outcome_levels, <span class="at">each =</span> <span class="dv">1</span>), <span class="at">levels =</span> outcome_levels)</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate survival curves based on the Cox model for m2</span></span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a>surv_fits_any <span class="ot">&lt;-</span> <span class="fu">survfit</span>(m2, <span class="at">newdata =</span> expanded_data)</span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors for the plot</span></span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Peace Agreement"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Ceasefire"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Gov Victory"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Rebel Victory"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Low Activity"</span> <span class="ot">=</span> <span class="st">"purple"</span>, <span class="st">"Actor Ceases"</span> <span class="ot">=</span> <span class="st">"cyan"</span>)</span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting survival curves for Any Recurrence with x-axis in years</span></span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a>plot_any <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(</span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>  surv_fits_any,</span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> expanded_data,</span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,  <span class="co"># Show p-value for log-rank test</span></span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">FALSE</span>,  <span class="co"># Show confidence intervals</span></span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Time in Years"</span>,</span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>,</span>
<span id="cb99-58"><a href="#cb99-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb99-59"><a href="#cb99-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>),  <span class="co"># Set the x-axis limit in years (adjust as needed)</span></span>
<span id="cb99-60"><a href="#cb99-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">break.time.by =</span> <span class="dv">5</span>,  <span class="co"># Break x-axis every 5 years</span></span>
<span id="cb99-61"><a href="#cb99-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,  <span class="co"># Show number at risk table</span></span>
<span id="cb99-62"><a href="#cb99-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">surv.scale =</span> <span class="st">"percent"</span>,</span>
<span id="cb99-63"><a href="#cb99-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="st">"Outcome"</span>,</span>
<span id="cb99-64"><a href="#cb99-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> <span class="fu">levels</span>(expanded_data<span class="sc">$</span>outcomes),  <span class="co"># Automatically use factor labels</span></span>
<span id="cb99-65"><a href="#cb99-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Survival Probability Over Time for War Recurrence Based on ACD Conflict ID"</span>,</span>
<span id="cb99-66"><a href="#cb99-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb99-67"><a href="#cb99-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb99-68"><a href="#cb99-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> colors,</span>
<span id="cb99-69"><a href="#cb99-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">1.2</span>,  <span class="co"># Increase line width for better visibility</span></span>
<span id="cb99-70"><a href="#cb99-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">linetype =</span> <span class="st">"solid"</span>  <span class="co"># Set line type to solid for all curves</span></span>
<span id="cb99-71"><a href="#cb99-71" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `gather_()` was deprecated in tidyr 1.2.0.
ℹ Please use `gather()` instead.
ℹ The deprecated feature was likely used in the survminer package.
  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .pvalue(fit, data = data, method = method, pval = pval, pval.coord = pval.coord, : There are no survival curves to be compared. 
 This is a null model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in (function (survsummary, times, survtable = c("cumevents",
"risk.table", : The length of legend.labs should be 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the legend font size and axis titles for Any Recurrence plot</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>plot_any<span class="sc">$</span>plot <span class="ot">&lt;-</span> plot_any<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Increase legend text size</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),  <span class="co"># Increase legend title size</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># X-axis title size</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Y-axis title size</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),  <span class="co"># X-axis text size and rotation</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),   <span class="co"># Y-axis text size</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))    <span class="co"># Plot title size</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the risk table text for Any Recurrence plot</span></span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>plot_any<span class="sc">$</span>table <span class="ot">&lt;-</span> plot_any<span class="sc">$</span>table <span class="sc">+</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># Breaks and labels in years</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate risk table text</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for x is already present.
Adding another scale for x, which will replace the existing scale.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate survival curves based on the Cox model for m4</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>surv_fits_side <span class="ot">&lt;-</span> <span class="fu">survfit</span>(m4, <span class="at">newdata =</span> expanded_data)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting survival curves for Side Recurrence with x-axis in years</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>plot_side <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  surv_fits_side,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> expanded_data,</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,  <span class="co"># Show p-value for log-rank test</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">FALSE</span>,  <span class="co"># Show confidence intervals</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Time in Years"</span>,</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>,</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>),  <span class="co"># Set the x-axis limit in years (adjust as needed)</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">break.time.by =</span> <span class="dv">5</span>,  <span class="co"># Break x-axis every 5 years</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,  <span class="co"># Show number at risk table</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">surv.scale =</span> <span class="st">"percent"</span>,</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="st">"Outcome"</span>,</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> <span class="fu">levels</span>(expanded_data<span class="sc">$</span>outcomes),  <span class="co"># Automatically use factor labels</span></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Survival Probability Over Time for War Recurrence Based on Sufficient Linkage"</span>,</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> colors,</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">1.2</span>,  <span class="co"># Increase line width for better visibility</span></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">linetype =</span> <span class="st">"solid"</span>  <span class="co"># Set line type to solid for all curves</span></span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .pvalue(fit, data = data, method = method, pval = pval, pval.coord = pval.coord, : There are no survival curves to be compared. 
 This is a null model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in (function (survsummary, times, survtable = c("cumevents",
"risk.table", : The length of legend.labs should be 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the legend font size and axis titles for Side Recurrence plot</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>plot_side<span class="sc">$</span>plot <span class="ot">&lt;-</span> plot_side<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Increase legend text size</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),  <span class="co"># Increase legend title size</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># X-axis title size</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Y-axis title size</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),  <span class="co"># X-axis text size and rotation</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),   <span class="co"># Y-axis text size</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))    <span class="co"># Plot title size</span></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the risk table text for Side Recurrence plot</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>plot_side<span class="sc">$</span>table <span class="ot">&lt;-</span> plot_side<span class="sc">$</span>table <span class="sc">+</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># Breaks and labels in years</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate risk table text</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for x is already present.
Adding another scale for x, which will replace the existing scale.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plots</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_any)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.
No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_side)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.
No shared levels found between `names(values)` of the manual scale and the
data's fill values.
No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="rsf-models" class="level2">
<h2 class="anchored" data-anchor-id="rsf-models">RSF Models</h2>
<section id="var-imp-with-rsf-any" class="level3">
<h3 class="anchored" data-anchor-id="var-imp-with-rsf-any">Var Imp with RSF: Any</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying labels</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>episodes_a <span class="ot">&lt;-</span> <span class="fu">apply_labels</span>(episodes, </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">time_to_recur_any =</span> <span class="st">"Time to Recur Any"</span>, </span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">recur_any =</span> <span class="st">"War Recurrence Any"</span>,  </span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dis =</span> <span class="st">"Actor Ceases"</span>, </span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cease =</span> <span class="st">"Ceasefire"</span>, </span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">govvic =</span> <span class="st">"Government Victory"</span>, </span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rebvic =</span> <span class="st">"Rebel Victory"</span>, </span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">lowac =</span> <span class="st">"Low Activity"</span>, </span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">W4 =</span> <span class="st">"Coalition Size"</span>, </span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pko_u =</span> <span class="st">"Peacekeeping Operations"</span>, </span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_dur =</span> <span class="st">"Log Duration"</span>, </span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cold_war =</span> <span class="st">"Cold War"</span>, </span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">p_polity2 =</span> <span class="st">"Polity Score"</span>, </span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fe_etfra =</span> <span class="st">"Ethnic Fractionalization"</span>, </span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_gdp =</span> <span class="st">"Log GDP per Capita"</span>,</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_pop =</span> <span class="st">"Log Population"</span>,</span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ps_original =</span> <span class="st">"Power-Sharing"</span>,</span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">al_religion2000 =</span> <span class="st">"Religion Fractionalization"</span>,</span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fe_cultdiv =</span> <span class="st">"Cultural Diversity"</span>,</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">veto_u =</span> <span class="st">"Veto Players"</span>,</span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">gov_war =</span> <span class="st">"War over Government"</span>,</span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ter_war =</span> <span class="st">"War over Territory"</span>)</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting data</span></span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes_a, <span class="at">select =</span> <span class="fu">c</span>(time_to_recur_any, recur_any, dis, cease, govvic, rebvic, lowac, pko_u, log_dur, cold_war, log_gdp, veto_u, gov_war, ter_war, p_polity2, fe_etfra, W4, log_pop, ps_original, al_religion2000, fe_cultdiv))</span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(X)</span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure numeric variables are correctly formatted</span></span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span></span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric))</span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cross-validation folds</span></span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(X<span class="sc">$</span>recur_any, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">list =</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store variable importance scores</span></span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>importance_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">length</span>(folds))</span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-40"><a href="#cb121-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation</span></span>
<span id="cb121-41"><a href="#cb121-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(folds)) {</span>
<span id="cb121-42"><a href="#cb121-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define training and validation sets</span></span>
<span id="cb121-43"><a href="#cb121-43" aria-hidden="true" tabindex="-1"></a>  train_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[<span class="sc">-</span>i])</span>
<span id="cb121-44"><a href="#cb121-44" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[i])</span>
<span id="cb121-45"><a href="#cb121-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-46"><a href="#cb121-46" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> X[train_indices, ]</span>
<span id="cb121-47"><a href="#cb121-47" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> X[test_indices, ]</span>
<span id="cb121-48"><a href="#cb121-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-49"><a href="#cb121-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Train the Random Survival Forest model</span></span>
<span id="cb121-50"><a href="#cb121-50" aria-hidden="true" tabindex="-1"></a>  rsf <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any) <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">ntree =</span> <span class="dv">1000</span>, <span class="at">nodesize =</span> <span class="dv">5</span>, <span class="at">nsplit =</span> <span class="dv">50</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb121-51"><a href="#cb121-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb121-52"><a href="#cb121-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the variable importance scores</span></span>
<span id="cb121-53"><a href="#cb121-53" aria-hidden="true" tabindex="-1"></a>  importance_list[[i]] <span class="ot">&lt;-</span> rsf<span class="sc">$</span>importance</span>
<span id="cb121-54"><a href="#cb121-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-55"><a href="#cb121-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-56"><a href="#cb121-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate variable importance scores</span></span>
<span id="cb121-57"><a href="#cb121-57" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(cbind, importance_list))</span>
<span id="cb121-58"><a href="#cb121-58" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(importance_df)</span>
<span id="cb121-59"><a href="#cb121-59" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(importance_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb121-60"><a href="#cb121-60" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Importance <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(importance_df[, <span class="sc">-</span><span class="fu">ncol</span>(importance_df)])</span>
<span id="cb121-61"><a href="#cb121-61" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> importance_df[, <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Importance"</span>)]</span>
<span id="cb121-62"><a href="#cb121-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-63"><a href="#cb121-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Relabeling variables for plot</span></span>
<span id="cb121-64"><a href="#cb121-64" aria-hidden="true" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Actor Ceases"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Government Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Low Activity"</span>, <span class="st">"Peacekeeping Operations"</span>, <span class="st">"Log Duration"</span>, <span class="st">"Cold War"</span>, <span class="st">"Log GDP per Capita"</span>, <span class="st">"Veto Players"</span>, <span class="st">"War over Government"</span>, <span class="st">"War over Territory"</span>, <span class="st">"Polity Score"</span>, <span class="st">"Ethnic Fractionalization"</span>, <span class="st">"Coalition Size"</span>, <span class="st">"Log Population"</span>, <span class="st">"Power-Sharing"</span>, <span class="st">"Religion Fractionalization"</span>, <span class="st">"Cultural Diversity"</span>)</span>
<span id="cb121-65"><a href="#cb121-65" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(var_labels) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dis"</span>, <span class="st">"cease"</span>, <span class="st">"govvic"</span>, <span class="st">"rebvic"</span>, <span class="st">"lowac"</span>, <span class="st">"pko_u"</span>, <span class="st">"log_dur"</span>, <span class="st">"cold_war"</span>, <span class="st">"log_gdp"</span>, <span class="st">"veto_u"</span>, <span class="st">"gov_war"</span>, <span class="st">"ter_war"</span>, <span class="st">"p_polity2"</span>, <span class="st">"fe_etfra"</span>, <span class="st">"W4"</span>, <span class="st">"log_pop"</span>, <span class="st">"ps_original"</span>, <span class="st">"al_religion2000"</span>, <span class="st">"fe_cultdiv"</span>)</span>
<span id="cb121-66"><a href="#cb121-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-67"><a href="#cb121-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding variable labels</span></span>
<span id="cb121-68"><a href="#cb121-68" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(importance_df<span class="sc">$</span>Variable, <span class="at">levels =</span> <span class="fu">names</span>(var_labels), <span class="at">labels =</span> var_labels[importance_df<span class="sc">$</span>Variable])</span>
<span id="cb121-69"><a href="#cb121-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-70"><a href="#cb121-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by importance</span></span>
<span id="cb121-71"><a href="#cb121-71" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> importance_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Importance))</span>
<span id="cb121-72"><a href="#cb121-72" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(importance_df<span class="sc">$</span>Variable, <span class="at">levels =</span> importance_df<span class="sc">$</span>Variable)</span>
<span id="cb121-73"><a href="#cb121-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-74"><a href="#cb121-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting using ggplot2</span></span>
<span id="cb121-75"><a href="#cb121-75" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(importance_df, <span class="fu">aes</span>(<span class="at">x =</span> Importance, <span class="at">y =</span> Variable)) <span class="sc">+</span></span>
<span id="cb121-76"><a href="#cb121-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb121-77"><a href="#cb121-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb121-78"><a href="#cb121-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variable Importance Based on UCDP"</span>, <span class="at">x =</span> <span class="st">"Variable Importance"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb121-79"><a href="#cb121-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="var-imp-with-rsf-link" class="level3">
<h3 class="anchored" data-anchor-id="var-imp-with-rsf-link">Var Imp with RSF: Link</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying labels</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>episodes_a <span class="ot">&lt;-</span> <span class="fu">apply_labels</span>(episodes, </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">time_to_recur =</span> <span class="st">"Time to Recur"</span>, </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">recur_side =</span> <span class="st">"War Recurrence"</span>,  </span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dis =</span> <span class="st">"Actor Ceases"</span>, </span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cease =</span> <span class="st">"Ceasefire"</span>, </span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">govvic =</span> <span class="st">"Government Victory"</span>, </span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rebvic =</span> <span class="st">"Rebel Victory"</span>, </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>                           <span class="at">lowac =</span> <span class="st">"Low Activity"</span>, </span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">W4 =</span> <span class="st">"Coalition Size"</span>, </span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pko_u =</span> <span class="st">"Peacekeeping Operations"</span>, </span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_dur =</span> <span class="st">"Log Duration"</span>, </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cold_war =</span> <span class="st">"Cold War"</span>, </span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>                           <span class="at">p_polity2 =</span> <span class="st">"Polity Score"</span>, </span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fe_etfra =</span> <span class="st">"Ethnic Fractionalization"</span>, </span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_gdp =</span> <span class="st">"Log GDP per Capita"</span>,</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_pop =</span> <span class="st">"Log Population"</span>,</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ps_original =</span> <span class="st">"Power-Sharing"</span>,</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>                           <span class="at">al_religion2000 =</span> <span class="st">"Religion Fractionalization"</span>,</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fe_cultdiv =</span> <span class="st">"Cultural Diversity"</span>,</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">veto_u =</span> <span class="st">"Veto Players"</span>,</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">gov_war =</span> <span class="st">"War over Government"</span>,</span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ter_war =</span> <span class="st">"War over Territory"</span>)</span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting data</span></span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes_a, <span class="at">select =</span> <span class="fu">c</span>(time_to_recur, recur_side, dis, cease, govvic, rebvic, lowac, pko_u, log_dur, cold_war, log_gdp, veto_u, gov_war, ter_war, p_polity2, fe_etfra, W4, log_pop, ps_original, al_religion2000, fe_cultdiv))</span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(X)</span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure numeric variables are correctly formatted</span></span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span></span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric))</span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cross-validation folds</span></span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(X<span class="sc">$</span>recur_side, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">list =</span> <span class="cn">TRUE</span>)</span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store variable importance scores</span></span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a>importance_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">length</span>(folds))</span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation</span></span>
<span id="cb122-41"><a href="#cb122-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(folds)) {</span>
<span id="cb122-42"><a href="#cb122-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define training and validation sets</span></span>
<span id="cb122-43"><a href="#cb122-43" aria-hidden="true" tabindex="-1"></a>  train_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[<span class="sc">-</span>i])</span>
<span id="cb122-44"><a href="#cb122-44" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[i])</span>
<span id="cb122-45"><a href="#cb122-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-46"><a href="#cb122-46" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> X[train_indices, ]</span>
<span id="cb122-47"><a href="#cb122-47" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> X[test_indices, ]</span>
<span id="cb122-48"><a href="#cb122-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-49"><a href="#cb122-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Train the Random Survival Forest model</span></span>
<span id="cb122-50"><a href="#cb122-50" aria-hidden="true" tabindex="-1"></a>  rsf <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(time_to_recur, recur_side) <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">ntree =</span> <span class="dv">1000</span>, <span class="at">nodesize =</span> <span class="dv">5</span>, <span class="at">nsplit =</span> <span class="dv">50</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb122-51"><a href="#cb122-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-52"><a href="#cb122-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the variable importance scores</span></span>
<span id="cb122-53"><a href="#cb122-53" aria-hidden="true" tabindex="-1"></a>  importance_list[[i]] <span class="ot">&lt;-</span> rsf<span class="sc">$</span>importance</span>
<span id="cb122-54"><a href="#cb122-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-55"><a href="#cb122-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-56"><a href="#cb122-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate variable importance scores</span></span>
<span id="cb122-57"><a href="#cb122-57" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(cbind, importance_list))</span>
<span id="cb122-58"><a href="#cb122-58" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(importance_df)</span>
<span id="cb122-59"><a href="#cb122-59" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(importance_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb122-60"><a href="#cb122-60" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Importance <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(importance_df[, <span class="sc">-</span><span class="fu">ncol</span>(importance_df)])</span>
<span id="cb122-61"><a href="#cb122-61" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> importance_df[, <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Importance"</span>)]</span>
<span id="cb122-62"><a href="#cb122-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-63"><a href="#cb122-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Relabeling variables for plot</span></span>
<span id="cb122-64"><a href="#cb122-64" aria-hidden="true" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Actor Ceases"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Government Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Low Activity"</span>, <span class="st">"Peacekeeping Operations"</span>, <span class="st">"Log Duration"</span>, <span class="st">"Cold War"</span>, <span class="st">"Log GDP per Capita"</span>, <span class="st">"Veto Players"</span>, <span class="st">"War over Government"</span>, <span class="st">"War over Territory"</span>, <span class="st">"Polity Score"</span>, <span class="st">"Ethnic Fractionalization"</span>, <span class="st">"Coalition Size"</span>, <span class="st">"Log Population"</span>, <span class="st">"Power-Sharing"</span>, <span class="st">"Religion Fractionalization"</span>, <span class="st">"Cultural Diversity"</span>)</span>
<span id="cb122-65"><a href="#cb122-65" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(var_labels) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dis"</span>, <span class="st">"cease"</span>, <span class="st">"govvic"</span>, <span class="st">"rebvic"</span>, <span class="st">"lowac"</span>, <span class="st">"pko_u"</span>, <span class="st">"log_dur"</span>, <span class="st">"cold_war"</span>, <span class="st">"log_gdp"</span>, <span class="st">"veto_u"</span>, <span class="st">"gov_war"</span>, <span class="st">"ter_war"</span>, <span class="st">"p_polity2"</span>, <span class="st">"fe_etfra"</span>, <span class="st">"W4"</span>, <span class="st">"log_pop"</span>, <span class="st">"ps_original"</span>, <span class="st">"al_religion2000"</span>, <span class="st">"fe_cultdiv"</span>)</span>
<span id="cb122-66"><a href="#cb122-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-67"><a href="#cb122-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding variable labels</span></span>
<span id="cb122-68"><a href="#cb122-68" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(importance_df<span class="sc">$</span>Variable, <span class="at">levels =</span> <span class="fu">names</span>(var_labels), <span class="at">labels =</span> var_labels[importance_df<span class="sc">$</span>Variable])</span>
<span id="cb122-69"><a href="#cb122-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-70"><a href="#cb122-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by importance</span></span>
<span id="cb122-71"><a href="#cb122-71" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> importance_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Importance))</span>
<span id="cb122-72"><a href="#cb122-72" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(importance_df<span class="sc">$</span>Variable, <span class="at">levels =</span> importance_df<span class="sc">$</span>Variable)</span>
<span id="cb122-73"><a href="#cb122-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-74"><a href="#cb122-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting using ggplot2</span></span>
<span id="cb122-75"><a href="#cb122-75" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(importance_df, <span class="fu">aes</span>(<span class="at">x =</span> Importance, <span class="at">y =</span> Variable)) <span class="sc">+</span></span>
<span id="cb122-76"><a href="#cb122-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb122-77"><a href="#cb122-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb122-78"><a href="#cb122-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variable Importance Based on Linkage"</span>, <span class="at">x =</span> <span class="st">"Variable Importance"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb122-79"><a href="#cb122-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rsf--any-survival-with-no-cv" class="level3">
<h3 class="anchored" data-anchor-id="rsf--any-survival-with-no-cv">RSF- Any Survival with No CV</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting and cleaning data</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, <span class="at">select =</span> <span class="fu">c</span>(time_to_recur_any, recur_any, dis, cease, govvic, rebvic, lowac, peace, W4, pko_u, log_dur, </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>                                   cold_war, p_polity2, fe_etfra, log_gdp, log_pop, ps_original, </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>                                   al_religion2000, fe_cultdiv, veto_u, gov_war, ter_war))</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(X)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric))</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert time to years</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>X<span class="sc">$</span>time_to_recur_any <span class="ot">&lt;-</span> X<span class="sc">$</span>time_to_recur_any <span class="sc">/</span> <span class="fl">365.25</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the Random Survival Forest model on the entire dataset</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any) <span class="sc">~</span> ., <span class="at">data =</span> X, <span class="at">ntree =</span> <span class="dv">1000</span>, <span class="at">nodesize =</span> <span class="dv">5</span>, <span class="at">nsplit =</span> <span class="dv">50</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict survival probabilities for the entire dataset</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, X, <span class="at">OOB =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>survival_probs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred<span class="sc">$</span>survival)</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract time points (already in years)</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>time_points <span class="ot">&lt;-</span> fit<span class="sc">$</span>time.interest</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(survival_probs) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Time"</span>, <span class="fu">round</span>(time_points, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>survival_probs<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(survival_probs)</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>X<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert survival probabilities to long format for plotting</span></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>survival_probs_long <span class="ot">&lt;-</span> survival_probs <span class="sc">%&gt;%</span></span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>id, <span class="at">names_to =</span> <span class="st">"Time"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"Time_"</span>, <span class="st">""</span>, Time)))</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with the original data to get the binary outcome variables</span></span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>survival_probs_long <span class="ot">&lt;-</span> <span class="fu">left_join</span>(survival_probs_long, X, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate mean and confidence intervals</span></span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>calculate_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Probability =</span> <span class="fu">mean</span>(Probability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> <span class="fu">sd</span>(Probability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">Lower_CI =</span> Mean_Probability <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(Probability)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(Probability)),</span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">Upper_CI =</span> Mean_Probability <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(Probability)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(Probability))</span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for each binary outcome variable</span></span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a>dis_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, dis <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a>cease_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, cease <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a>govvic_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, govvic <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a>rebvic_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, rebvic <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true" tabindex="-1"></a>lowac_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, lowac <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true" tabindex="-1"></a>peace_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, peace <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-52"><a href="#cb123-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot using ggplot2, one line per variable of interest with confidence intervals</span></span>
<span id="cb123-53"><a href="#cb123-53" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb123-54"><a href="#cb123-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dis_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Disappearance"</span>)) <span class="sc">+</span></span>
<span id="cb123-55"><a href="#cb123-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> dis_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Disappearance"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb123-56"><a href="#cb123-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cease_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Ceasefire"</span>)) <span class="sc">+</span></span>
<span id="cb123-57"><a href="#cb123-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> cease_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Ceasefire"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb123-58"><a href="#cb123-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> govvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Government Victory"</span>)) <span class="sc">+</span></span>
<span id="cb123-59"><a href="#cb123-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> govvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Government Victory"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb123-60"><a href="#cb123-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> rebvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Rebel Victory"</span>)) <span class="sc">+</span></span>
<span id="cb123-61"><a href="#cb123-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> rebvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Rebel Victory"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb123-62"><a href="#cb123-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lowac_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Low Activity"</span>)) <span class="sc">+</span></span>
<span id="cb123-63"><a href="#cb123-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> lowac_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Low Activity"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb123-64"><a href="#cb123-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> peace_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Peace Agreement"</span>)) <span class="sc">+</span></span>
<span id="cb123-65"><a href="#cb123-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> peace_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Peace Agreement"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb123-66"><a href="#cb123-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(survival_probs_long<span class="sc">$</span>Time), <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># Set breaks every 5 years</span></span>
<span id="cb123-67"><a href="#cb123-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Survival Probabilities Over Time"</span>, <span class="at">x =</span> <span class="st">"Time (Years)"</span>, <span class="at">y =</span> <span class="st">"Survival Probability"</span>, <span class="at">color =</span> <span class="st">"Variable"</span>, <span class="at">fill =</span> <span class="st">"Variable"</span>) <span class="sc">+</span></span>
<span id="cb123-68"><a href="#cb123-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb123-69"><a href="#cb123-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rsf--side-survival-with-no-cv" class="level3">
<h3 class="anchored" data-anchor-id="rsf--side-survival-with-no-cv">RSF- Side Survival with No CV</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting and cleaning data</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, <span class="at">select =</span> <span class="fu">c</span>(time_to_recur, recur_side, dis, cease, govvic, rebvic, lowac, peace, W4, pko_u, log_dur, </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>                                   cold_war, p_polity2, fe_etfra, log_gdp, log_pop, ps_original, </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>                                   al_religion2000, fe_cultdiv, veto_u, gov_war, ter_war))</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(X)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric))</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert time to years</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>X<span class="sc">$</span>time_to_recur <span class="ot">&lt;-</span> X<span class="sc">$</span>time_to_recur <span class="sc">/</span> <span class="fl">365.25</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the Random Survival Forest model on the entire dataset</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(time_to_recur, recur_side) <span class="sc">~</span> ., <span class="at">data =</span> X, <span class="at">ntree =</span> <span class="dv">1000</span>, <span class="at">nodesize =</span> <span class="dv">5</span>, <span class="at">nsplit =</span> <span class="dv">50</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict survival probabilities for the entire dataset</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, X, <span class="at">OOB =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>survival_probs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred<span class="sc">$</span>survival)</span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract time points (already in years)</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>time_points <span class="ot">&lt;-</span> fit<span class="sc">$</span>time.interest</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(survival_probs) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Time"</span>, <span class="fu">round</span>(time_points, <span class="dv">2</span>), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a>survival_probs<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(survival_probs)</span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>X<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)</span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert survival probabilities to long format for plotting</span></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>survival_probs_long <span class="ot">&lt;-</span> survival_probs <span class="sc">%&gt;%</span></span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>id, <span class="at">names_to =</span> <span class="st">"Time"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"Time_"</span>, <span class="st">""</span>, Time)))</span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with the original data to get the binary outcome variables</span></span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>survival_probs_long <span class="ot">&lt;-</span> <span class="fu">left_join</span>(survival_probs_long, X, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate mean and confidence intervals</span></span>
<span id="cb124-33"><a href="#cb124-33" aria-hidden="true" tabindex="-1"></a>calculate_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb124-34"><a href="#cb124-34" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb124-35"><a href="#cb124-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb124-36"><a href="#cb124-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb124-37"><a href="#cb124-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Probability =</span> <span class="fu">mean</span>(Probability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb124-38"><a href="#cb124-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> <span class="fu">sd</span>(Probability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb124-39"><a href="#cb124-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">Lower_CI =</span> Mean_Probability <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(Probability)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(Probability)),</span>
<span id="cb124-40"><a href="#cb124-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">Upper_CI =</span> Mean_Probability <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(Probability)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(Probability))</span>
<span id="cb124-41"><a href="#cb124-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb124-42"><a href="#cb124-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-43"><a href="#cb124-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-44"><a href="#cb124-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for each binary outcome variable</span></span>
<span id="cb124-45"><a href="#cb124-45" aria-hidden="true" tabindex="-1"></a>dis_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, dis <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb124-46"><a href="#cb124-46" aria-hidden="true" tabindex="-1"></a>cease_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, cease <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb124-47"><a href="#cb124-47" aria-hidden="true" tabindex="-1"></a>govvic_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, govvic <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb124-48"><a href="#cb124-48" aria-hidden="true" tabindex="-1"></a>rebvic_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, rebvic <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb124-49"><a href="#cb124-49" aria-hidden="true" tabindex="-1"></a>lowac_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, lowac <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb124-50"><a href="#cb124-50" aria-hidden="true" tabindex="-1"></a>peace_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, peace <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb124-51"><a href="#cb124-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-52"><a href="#cb124-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot using ggplot2, one line per variable of interest with confidence intervals</span></span>
<span id="cb124-53"><a href="#cb124-53" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb124-54"><a href="#cb124-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dis_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Disappearance"</span>)) <span class="sc">+</span></span>
<span id="cb124-55"><a href="#cb124-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> dis_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Disappearance"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb124-56"><a href="#cb124-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cease_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Ceasefire"</span>)) <span class="sc">+</span></span>
<span id="cb124-57"><a href="#cb124-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> cease_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Ceasefire"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb124-58"><a href="#cb124-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> govvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Government Victory"</span>)) <span class="sc">+</span></span>
<span id="cb124-59"><a href="#cb124-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> govvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Government Victory"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb124-60"><a href="#cb124-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> rebvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Rebel Victory"</span>)) <span class="sc">+</span></span>
<span id="cb124-61"><a href="#cb124-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> rebvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Rebel Victory"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb124-62"><a href="#cb124-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> lowac_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Low Activity"</span>)) <span class="sc">+</span></span>
<span id="cb124-63"><a href="#cb124-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> lowac_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Low Activity"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb124-64"><a href="#cb124-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> peace_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Peace Agreement"</span>)) <span class="sc">+</span></span>
<span id="cb124-65"><a href="#cb124-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> peace_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Peace Agreement"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb124-66"><a href="#cb124-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(survival_probs_long<span class="sc">$</span>Time), <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span>  <span class="co"># Set breaks every 5 years</span></span>
<span id="cb124-67"><a href="#cb124-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Survival Probabilities Over Time"</span>, <span class="at">x =</span> <span class="st">"Time (Years)"</span>, <span class="at">y =</span> <span class="st">"Survival Probability"</span>, <span class="at">color =</span> <span class="st">"Variable"</span>, <span class="at">fill =</span> <span class="st">"Variable"</span>) <span class="sc">+</span></span>
<span id="cb124-68"><a href="#cb124-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb124-69"><a href="#cb124-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="no-low-ac" class="level2">
<h2 class="anchored" data-anchor-id="no-low-ac">No Low Ac</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">### remove low activity cases</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>episodes <span class="ot">&lt;-</span> episodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lowac <span class="sc">!=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="kaplan-mier-curves" class="level3">
<h3 class="anchored" data-anchor-id="kaplan-mier-curves">Kaplan-Mier Curves</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new dataframe from episodes</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>new_episodes <span class="ot">&lt;-</span> episodes</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the numerical outcome variable to a factor with appropriate labels, excluding "Low Activity"</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="sc">$</span>outcome <span class="ot">&lt;-</span> <span class="fu">factor</span>(new_episodes<span class="sc">$</span>outcome, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>),</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Peace Agreement"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Gov Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Actor Ceases"</span>))</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the levels of the outcome variable</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">levels</span>(new_episodes<span class="sc">$</span>outcome))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Peace Agreement" "Ceasefire"       "Gov Victory"     "Rebel Victory"  
[5] "Actor Ceases"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect the distribution of survival times</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(new_episodes<span class="sc">$</span>time_to_recur_any)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    369    1365    4705    6941   10768   27774 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(new_episodes<span class="sc">$</span>time_to_recur)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
    560    3189    9357   10573   16567   28034 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trim follow-up time to 20,000 days</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="sc">$</span>time_to_recur_any <span class="ot">&lt;-</span> <span class="fu">pmin</span>(new_episodes<span class="sc">$</span>time_to_recur_any, <span class="dv">20000</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>new_episodes<span class="sc">$</span>time_to_recur <span class="ot">&lt;-</span> <span class="fu">pmin</span>(new_episodes<span class="sc">$</span>time_to_recur, <span class="dv">20000</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the Kaplan-Meier survival curves for the first plot</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>km_fit_outcome_any <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any) <span class="sc">~</span> outcome, <span class="at">data =</span> new_episodes)</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Kaplan-Meier survival curves with percentages in the risk table</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>km_plot_any <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(km_fit_outcome_any, <span class="at">data =</span> new_episodes,</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">pval =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">FALSE</span>,</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">risk.table =</span> <span class="cn">TRUE</span>, <span class="at">risk.table.col =</span> <span class="st">"strata"</span>,</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">risk.table.y.text.col =</span> <span class="cn">TRUE</span>, </span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">risk.table.height =</span> <span class="fl">0.25</span>,</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">risk.table.title =</span> <span class="st">"Number at Risk"</span>,</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(),</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"brown"</span>),</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">title =</span> <span class="st">"KM Survival Curves for Outcomes (Any Recurrence)"</span>,</span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>,</span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">tables.y.text =</span> <span class="cn">FALSE</span>)</span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the survival plot to add grid lines</span></span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>km_plot_any<span class="sc">$</span>plot <span class="ot">&lt;-</span> km_plot_any<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Increase legend text size</span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Increase legend title size</span></span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># X-axis title size</span></span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Y-axis title size</span></span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),   <span class="co"># X-axis text size</span></span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),   <span class="co"># Y-axis text size</span></span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),    <span class="co"># Plot title size</span></span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.5</span>),  <span class="co"># Add major grid lines</span></span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"lightgray"</span>, <span class="at">size =</span> <span class="fl">0.25</span>))  <span class="co"># Add minor grid lines</span></span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove grid lines from the risk table</span></span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a>km_plot_any<span class="sc">$</span>risk.table <span class="ot">&lt;-</span> km_plot_any<span class="sc">$</span>risk.table <span class="sc">+</span> </span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the Kaplan-Meier survival curves for the second plot</span></span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a>km_fit_outcome_side <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time_to_recur, recur_side) <span class="sc">~</span> outcome, <span class="at">data =</span> new_episodes)</span>
<span id="cb132-40"><a href="#cb132-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-41"><a href="#cb132-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Kaplan-Meier survival curves with percentages in the risk table for the second plot</span></span>
<span id="cb132-42"><a href="#cb132-42" aria-hidden="true" tabindex="-1"></a>km_plot_side <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(km_fit_outcome_side, <span class="at">data =</span> new_episodes,</span>
<span id="cb132-43"><a href="#cb132-43" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pval =</span> <span class="cn">TRUE</span>, <span class="at">conf.int =</span> <span class="cn">FALSE</span>,</span>
<span id="cb132-44"><a href="#cb132-44" aria-hidden="true" tabindex="-1"></a>                           <span class="at">risk.table =</span> <span class="cn">TRUE</span>, <span class="at">risk.table.col =</span> <span class="st">"strata"</span>,</span>
<span id="cb132-45"><a href="#cb132-45" aria-hidden="true" tabindex="-1"></a>                           <span class="at">risk.table.y.text.col =</span> <span class="cn">TRUE</span>, </span>
<span id="cb132-46"><a href="#cb132-46" aria-hidden="true" tabindex="-1"></a>                           <span class="at">risk.table.height =</span> <span class="fl">0.25</span>,</span>
<span id="cb132-47"><a href="#cb132-47" aria-hidden="true" tabindex="-1"></a>                           <span class="at">risk.table.title =</span> <span class="st">"Number at Risk"</span>,</span>
<span id="cb132-48"><a href="#cb132-48" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ggtheme =</span> <span class="fu">theme_classic</span>(),</span>
<span id="cb132-49"><a href="#cb132-49" aria-hidden="true" tabindex="-1"></a>                           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span>, <span class="st">"brown"</span>),</span>
<span id="cb132-50"><a href="#cb132-50" aria-hidden="true" tabindex="-1"></a>                           <span class="at">title =</span> <span class="st">"KM Survival Curves for Outcomes (Side Recurrence)"</span>,</span>
<span id="cb132-51"><a href="#cb132-51" aria-hidden="true" tabindex="-1"></a>                           <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>,</span>
<span id="cb132-52"><a href="#cb132-52" aria-hidden="true" tabindex="-1"></a>                           <span class="at">tables.y.text =</span> <span class="cn">FALSE</span>)</span>
<span id="cb132-53"><a href="#cb132-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-54"><a href="#cb132-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the survival plot to add grid lines</span></span>
<span id="cb132-55"><a href="#cb132-55" aria-hidden="true" tabindex="-1"></a>km_plot_side<span class="sc">$</span>plot <span class="ot">&lt;-</span> km_plot_side<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb132-56"><a href="#cb132-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Increase legend text size</span></span>
<span id="cb132-57"><a href="#cb132-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Increase legend title size</span></span>
<span id="cb132-58"><a href="#cb132-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># X-axis title size</span></span>
<span id="cb132-59"><a href="#cb132-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Y-axis title size</span></span>
<span id="cb132-60"><a href="#cb132-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),   <span class="co"># X-axis text size</span></span>
<span id="cb132-61"><a href="#cb132-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),   <span class="co"># Y-axis text size</span></span>
<span id="cb132-62"><a href="#cb132-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),    <span class="co"># Plot title size</span></span>
<span id="cb132-63"><a href="#cb132-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">size =</span> <span class="fl">0.5</span>),  <span class="co"># Add major grid lines</span></span>
<span id="cb132-64"><a href="#cb132-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"lightgray"</span>, <span class="at">size =</span> <span class="fl">0.25</span>))  <span class="co"># Add minor grid lines</span></span>
<span id="cb132-65"><a href="#cb132-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-66"><a href="#cb132-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove grid lines from the risk table</span></span>
<span id="cb132-67"><a href="#cb132-67" aria-hidden="true" tabindex="-1"></a>km_plot_side<span class="sc">$</span>risk.table <span class="ot">&lt;-</span> km_plot_side<span class="sc">$</span>risk.table <span class="sc">+</span> </span>
<span id="cb132-68"><a href="#cb132-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb132-69"><a href="#cb132-69" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span>
<span id="cb132-70"><a href="#cb132-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-71"><a href="#cb132-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plots</span></span>
<span id="cb132-72"><a href="#cb132-72" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(km_plot_any)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(km_plot_side)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cox-models-1" class="level3">
<h3 class="anchored" data-anchor-id="cox-models-1">Cox models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Models</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any) <span class="sc">~</span> dis <span class="sc">+</span> cease <span class="sc">+</span> govvic <span class="sc">+</span> rebvic, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any) <span class="sc">~</span> dis <span class="sc">+</span> cease <span class="sc">+</span> govvic <span class="sc">+</span> rebvic <span class="sc">+</span> pko_u <span class="sc">+</span> log_dur <span class="sc">+</span> cold_war <span class="sc">+</span> log_gdp <span class="sc">+</span> veto_u <span class="sc">+</span> gov_war <span class="sc">+</span> ter_war <span class="sc">+</span> p_polity2 <span class="sc">+</span> fe_etfra <span class="sc">+</span> W4 <span class="sc">+</span> log_pop <span class="sc">+</span> al_language2000 <span class="sc">+</span> ps_original <span class="sc">+</span> al_religion2000 <span class="sc">+</span> fe_cultdiv, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur, recur_side) <span class="sc">~</span> dis <span class="sc">+</span> cease <span class="sc">+</span> govvic <span class="sc">+</span> rebvic, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur, recur_side) <span class="sc">~</span> dis <span class="sc">+</span> cease <span class="sc">+</span> govvic <span class="sc">+</span> rebvic <span class="sc">+</span> pko_u <span class="sc">+</span> log_dur <span class="sc">+</span> cold_war <span class="sc">+</span> log_gdp <span class="sc">+</span> veto_u <span class="sc">+</span> gov_war <span class="sc">+</span> ter_war <span class="sc">+</span> p_polity2 <span class="sc">+</span> fe_etfra <span class="sc">+</span> W4 <span class="sc">+</span> log_pop <span class="sc">+</span> al_language2000 <span class="sc">+</span> ps_original <span class="sc">+</span> al_religion2000 <span class="sc">+</span> fe_cultdiv, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(m1, m2, m3, m4, <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==================================================================================================
                                                  Dependent variable:                             
                     -----------------------------------------------------------------------------
                               time_to_recur_any                        time_to_recur             
                            (1)                 (2)                (3)                 (4)        
--------------------------------------------------------------------------------------------------
dis                        -0.472              0.349              -0.440             -0.160       
                          (0.459)             (0.667)            (0.503)             (0.747)      
                                                                                                  
cease                     0.620**             1.351**            0.678**              0.778       
                          (0.263)             (0.445)            (0.284)             (0.471)      
                                                                                                  
govvic                     -0.222              0.370             -0.790**            -0.252       
                          (0.253)             (0.455)            (0.309)             (0.528)      
                                                                                                  
rebvic                     0.086               0.831             -0.924**            -0.227       
                          (0.296)             (0.521)            (0.423)             (0.696)      
                                                                                                  
pko_u                                         -0.552                                 -0.691       
                                              (0.462)                                (0.527)      
                                                                                                  
log_dur                                       0.082*                                  0.065       
                                              (0.045)                                (0.061)      
                                                                                                  
cold_war                                      -0.420                                -1.074***     
                                              (0.275)                                (0.358)      
                                                                                                  
log_gdp                                        0.003                                 -0.110       
                                              (0.090)                                (0.113)      
                                                                                                  
veto_u                                        0.390**                                0.344*       
                                              (0.146)                                (0.166)      
                                                                                                  
gov_war                                        0.401                                 -0.264       
                                              (0.266)                                (0.302)      
                                                                                                  
ter_war                                                                                           
                                              (0.000)                                (0.000)      
                                                                                                  
p_polity2                                      0.010                                 -0.045       
                                              (0.037)                                (0.046)      
                                                                                                  
fe_etfra                                       0.496                                 -0.451       
                                              (1.001)                                (1.168)      
                                                                                                  
W4                                            -0.861                                  1.523       
                                              (1.122)                                (1.487)      
                                                                                                  
log_pop                                       0.117*                                 -0.032       
                                              (0.071)                                (0.088)      
                                                                                                  
al_language2000                               1.737**                               2.493***      
                                              (0.700)                                (0.891)      
                                                                                                  
ps_original                                    0.055                                 -0.137       
                                              (0.349)                                (0.418)      
                                                                                                  
al_religion2000                               -0.690                                 -0.916       
                                              (0.544)                                (0.663)      
                                                                                                  
fe_cultdiv                                    -1.729                                 -1.586       
                                              (0.995)                                (1.263)      
                                                                                                  
--------------------------------------------------------------------------------------------------
Observations                254                 173                254                 173        
R2                         0.062               0.251              0.134               0.291       
Max. Possible R2           0.996               0.995              0.977               0.977       
Log Likelihood            -705.245           -440.117            -458.157           -297.331      
Wald Test            15.440*** (df = 4) 64.930*** (df = 18) 42.750*** (df = 4) 64.860*** (df = 18)
LR Test              16.391*** (df = 4) 49.916*** (df = 18) 36.449*** (df = 4) 59.464*** (df = 18)
Score (Logrank) Test 18.506*** (df = 4) 54.963*** (df = 18) 43.412*** (df = 4) 61.667*** (df = 18)
==================================================================================================
Note:                                                                  *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(m1, m2, m3, m4,</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ord.intercepts =</span> <span class="cn">TRUE</span>,</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">dep.var.labels =</span> <span class="fu">c</span>(<span class="st">"UCDP ID-Based War Recurrence"</span>, <span class="st">"UCDP ID-Based War Recurrence"</span>, <span class="st">"Linkage-Based War Recurrence"</span>, <span class="st">"Linkage-Based War Recurrence"</span>),</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">covariate.labels =</span> <span class="fu">c</span>(<span class="st">"Actor Ceases"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Government Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Peacekeeping Missions"</span>, <span class="st">"Log(Duration)"</span>, <span class="st">"Cold War"</span>, <span class="st">"Log(GDP per Capita)"</span>, <span class="st">"Number of Veto Players"</span>, <span class="st">"War over Government"</span>, <span class="st">"War over Territory"</span>, <span class="st">"Polity Score"</span>, <span class="st">"Ethnic Fractionalization"</span>, <span class="st">"Coalition Size"</span>, <span class="st">"Log(Population)"</span>, <span class="st">"Language Fractionalization"</span>, <span class="st">"Power-Sharing"</span>, <span class="st">"Religion Fractionalization"</span>, <span class="st">"Cultural Diversity"</span>), </span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
========================================================================================================
                                                        Dependent variable:                             
                           -----------------------------------------------------------------------------
                                UCDP ID-Based War Recurrence           UCDP ID-Based War Recurrence     
                                  (1)                 (2)                (3)                 (4)        
--------------------------------------------------------------------------------------------------------
Actor Ceases                     -0.472              0.349              -0.440             -0.160       
                                (0.459)             (0.667)            (0.503)             (0.747)      
                                                                                                        
Ceasefire                       0.620**             1.351**            0.678**              0.778       
                                (0.263)             (0.445)            (0.284)             (0.471)      
                                                                                                        
Government Victory               -0.222              0.370             -0.790**            -0.252       
                                (0.253)             (0.455)            (0.309)             (0.528)      
                                                                                                        
Rebel Victory                    0.086               0.831             -0.924**            -0.227       
                                (0.296)             (0.521)            (0.423)             (0.696)      
                                                                                                        
Peacekeeping Missions                               -0.552                                 -0.691       
                                                    (0.462)                                (0.527)      
                                                                                                        
Log(Duration)                                       0.082*                                  0.065       
                                                    (0.045)                                (0.061)      
                                                                                                        
Cold War                                            -0.420                                -1.074***     
                                                    (0.275)                                (0.358)      
                                                                                                        
Log(GDP per Capita)                                  0.003                                 -0.110       
                                                    (0.090)                                (0.113)      
                                                                                                        
Number of Veto Players                              0.390**                                0.344*       
                                                    (0.146)                                (0.166)      
                                                                                                        
War over Government                                  0.401                                 -0.264       
                                                    (0.266)                                (0.302)      
                                                                                                        
War over Territory                                                                                      
                                                    (0.000)                                (0.000)      
                                                                                                        
Polity Score                                         0.010                                 -0.045       
                                                    (0.037)                                (0.046)      
                                                                                                        
Ethnic Fractionalization                             0.496                                 -0.451       
                                                    (1.001)                                (1.168)      
                                                                                                        
Coalition Size                                      -0.861                                  1.523       
                                                    (1.122)                                (1.487)      
                                                                                                        
Log(Population)                                     0.117*                                 -0.032       
                                                    (0.071)                                (0.088)      
                                                                                                        
Language Fractionalization                          1.737**                               2.493***      
                                                    (0.700)                                (0.891)      
                                                                                                        
Power-Sharing                                        0.055                                 -0.137       
                                                    (0.349)                                (0.418)      
                                                                                                        
Religion Fractionalization                          -0.690                                 -0.916       
                                                    (0.544)                                (0.663)      
                                                                                                        
Cultural Diversity                                  -1.729                                 -1.586       
                                                    (0.995)                                (1.263)      
                                                                                                        
--------------------------------------------------------------------------------------------------------
Observations                      254                 173                254                 173        
R2                               0.062               0.251              0.134               0.291       
Max. Possible R2                 0.996               0.995              0.977               0.977       
Log Likelihood                  -705.245           -440.117            -458.157           -297.331      
Wald Test                  15.440*** (df = 4) 64.930*** (df = 18) 42.750*** (df = 4) 64.860*** (df = 18)
LR Test                    16.391*** (df = 4) 49.916*** (df = 18) 36.449*** (df = 4) 59.464*** (df = 18)
Score (Logrank) Test       18.506*** (df = 4) 54.963*** (df = 18) 43.412*** (df = 4) 61.667*** (df = 18)
========================================================================================================
Note:                                                                        *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
</section>
<section id="coefficient-plots-fom-cox" class="level3">
<h3 class="anchored" data-anchor-id="coefficient-plots-fom-cox">Coefficient Plots fom Cox</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting model coefficients and robust standard errors from the summary</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>coef_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(m2)<span class="sc">$</span>coefficients</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename terms for better readability</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>terms_rename <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dis"</span> <span class="ot">=</span> <span class="st">"Actor Ceases"</span>,</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cease"</span> <span class="ot">=</span> <span class="st">"Ceasefire"</span>,</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"govvic"</span> <span class="ot">=</span> <span class="st">"Government Victory"</span>,</span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"rebvic"</span> <span class="ot">=</span> <span class="st">"Rebel Victory"</span>,</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pko_u"</span> <span class="ot">=</span> <span class="st">"Peacekeeping Missions"</span>,</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log_dur"</span> <span class="ot">=</span> <span class="st">"Log(Duration)"</span>,</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cold_war"</span> <span class="ot">=</span> <span class="st">"Cold War"</span>,</span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log_gdp"</span> <span class="ot">=</span> <span class="st">"Log(GDP per Capita)"</span>,</span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"veto_u"</span> <span class="ot">=</span> <span class="st">"Number of Veto Players"</span>,</span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gov_war"</span> <span class="ot">=</span> <span class="st">"War over Government"</span>,</span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ter_war"</span> <span class="ot">=</span> <span class="st">"War over Territory"</span>,</span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"p_polity2"</span> <span class="ot">=</span> <span class="st">"Polity Score"</span>,</span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fe_etfra"</span> <span class="ot">=</span> <span class="st">"Ethnic Fractionalization"</span>,</span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"W4"</span> <span class="ot">=</span> <span class="st">"Coalition Size"</span>,</span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log_pop"</span> <span class="ot">=</span> <span class="st">"Log(Population)"</span>,</span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"al_language2000"</span> <span class="ot">=</span> <span class="st">"Language Fractionalization"</span>,</span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ps_original"</span> <span class="ot">=</span> <span class="st">"Power-Sharing"</span>,</span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"al_religion2000"</span> <span class="ot">=</span> <span class="st">"Religion Fractionalization"</span>,</span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fe_cultdiv"</span> <span class="ot">=</span> <span class="st">"Cultural Diversity"</span></span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for plotting</span></span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>df_coef <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coef_summary),</span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coef_summary[, <span class="st">"coef"</span>],</span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdErr =</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> coef_summary[, <span class="st">"coef"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> coef_summary[, <span class="st">"coef"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> coef_summary[, <span class="st">"Pr(&gt;|z|)"</span>]</span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-37"><a href="#cb138-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the renaming to the Term column</span></span>
<span id="cb138-38"><a href="#cb138-38" aria-hidden="true" tabindex="-1"></a>df_coef<span class="sc">$</span>Term <span class="ot">&lt;-</span> terms_rename[df_coef<span class="sc">$</span>Term]</span>
<span id="cb138-39"><a href="#cb138-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-40"><a href="#cb138-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting using ggplot2</span></span>
<span id="cb138-41"><a href="#cb138-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb138-42"><a href="#cb138-42" aria-hidden="true" tabindex="-1"></a>cofp_any<span class="ot">&lt;-</span><span class="fu">ggplot</span>(df_coef, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> Term)) <span class="sc">+</span></span>
<span id="cb138-43"><a href="#cb138-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb138-44"><a href="#cb138-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower, <span class="at">xmax =</span> Upper), <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="fu">ifelse</span>(df_coef<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"blue"</span>, <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb138-45"><a href="#cb138-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-46"><a href="#cb138-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Coefficient Plot of Cox Model: UCDP"</span>,</span>
<span id="cb138-47"><a href="#cb138-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Coefficient Value"</span>,</span>
<span id="cb138-48"><a href="#cb138-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variables"</span>)</span>
<span id="cb138-49"><a href="#cb138-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-50"><a href="#cb138-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting model coefficients and robust standard errors from the summary</span></span>
<span id="cb138-51"><a href="#cb138-51" aria-hidden="true" tabindex="-1"></a>coef_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(m4)<span class="sc">$</span>coefficients</span>
<span id="cb138-52"><a href="#cb138-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-53"><a href="#cb138-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dataframe for plotting</span></span>
<span id="cb138-54"><a href="#cb138-54" aria-hidden="true" tabindex="-1"></a>df_coef <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb138-55"><a href="#cb138-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">Term =</span> <span class="fu">rownames</span>(coef_summary),</span>
<span id="cb138-56"><a href="#cb138-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> coef_summary[, <span class="st">"coef"</span>],</span>
<span id="cb138-57"><a href="#cb138-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">StdErr =</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb138-58"><a href="#cb138-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lower =</span> coef_summary[, <span class="st">"coef"</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb138-59"><a href="#cb138-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">Upper =</span> coef_summary[, <span class="st">"coef"</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> coef_summary[, <span class="st">"robust se"</span>],</span>
<span id="cb138-60"><a href="#cb138-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_value =</span> coef_summary[, <span class="st">"Pr(&gt;|z|)"</span>]</span>
<span id="cb138-61"><a href="#cb138-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb138-62"><a href="#cb138-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-63"><a href="#cb138-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the renaming to the Term column</span></span>
<span id="cb138-64"><a href="#cb138-64" aria-hidden="true" tabindex="-1"></a>df_coef<span class="sc">$</span>Term <span class="ot">&lt;-</span> terms_rename[df_coef<span class="sc">$</span>Term]</span>
<span id="cb138-65"><a href="#cb138-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-66"><a href="#cb138-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting using ggplot2</span></span>
<span id="cb138-67"><a href="#cb138-67" aria-hidden="true" tabindex="-1"></a>cofp_side<span class="ot">&lt;-</span><span class="fu">ggplot</span>(df_coef, <span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> Term)) <span class="sc">+</span></span>
<span id="cb138-68"><a href="#cb138-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb138-69"><a href="#cb138-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower, <span class="at">xmax =</span> Upper), <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="fu">ifelse</span>(df_coef<span class="sc">$</span>p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"blue"</span>, <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb138-70"><a href="#cb138-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb138-71"><a href="#cb138-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Coefficient Plot of Cox Model: Link"</span>,</span>
<span id="cb138-72"><a href="#cb138-72" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Coefficient Value"</span>,</span>
<span id="cb138-73"><a href="#cb138-73" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="survival-rates-from-cox-1" class="level3">
<h3 class="anchored" data-anchor-id="survival-rates-from-cox-1">Survival rates from Cox</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define factor levels and labels without "Low Activity"</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>outcome_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Peace Agreement"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Gov Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Actor Ceases"</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert outcome variable to factor with specified levels in the original dataset</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>episodes<span class="sc">$</span>outcomes <span class="ot">&lt;-</span> <span class="fu">factor</span>(episodes<span class="sc">$</span>outcome, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>), <span class="at">labels =</span> outcome_levels)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any) <span class="sc">~</span> <span class="fu">as.factor</span>(outcomes) <span class="sc">+</span> pko_u <span class="sc">+</span> log_dur <span class="sc">+</span> cold_war <span class="sc">+</span> log_gdp <span class="sc">+</span> veto_u <span class="sc">+</span> gov_war <span class="sc">+</span> ter_war <span class="sc">+</span> p_polity2 <span class="sc">+</span> fe_etfra <span class="sc">+</span> W4 <span class="sc">+</span> log_pop <span class="sc">+</span> al_language2000 <span class="sc">+</span> ps_original <span class="sc">+</span> al_religion2000 <span class="sc">+</span> fe_cultdiv, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time_to_recur, recur_side) <span class="sc">~</span> <span class="fu">as.factor</span>(outcomes) <span class="sc">+</span> pko_u <span class="sc">+</span> log_dur <span class="sc">+</span> cold_war <span class="sc">+</span> log_gdp <span class="sc">+</span> veto_u <span class="sc">+</span> gov_war <span class="sc">+</span> ter_war <span class="sc">+</span> p_polity2 <span class="sc">+</span> fe_etfra <span class="sc">+</span> W4 <span class="sc">+</span> log_pop <span class="sc">+</span> al_language2000 <span class="sc">+</span> ps_original <span class="sc">+</span> al_religion2000 <span class="sc">+</span> fe_cultdiv, <span class="at">data =</span> episodes, <span class="at">cluster =</span> conflict_id, <span class="at">robust =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>representative_data <span class="ot">&lt;-</span> episodes <span class="sc">%&gt;%</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pko_u =</span> <span class="fu">median</span>(<span class="fu">as.numeric</span>(pko_u), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_dur =</span> <span class="fu">mean</span>(log_dur, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">cold_war =</span> <span class="fu">median</span>(cold_war, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_gdp =</span> <span class="fu">mean</span>(log_gdp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">veto_u =</span> <span class="fu">median</span>(veto_u, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">gov_war =</span> <span class="fu">median</span>(gov_war, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ter_war =</span> <span class="fu">median</span>(ter_war, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_polity2 =</span> <span class="fu">mean</span>(p_polity2, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fe_etfra =</span> <span class="fu">mean</span>(fe_etfra, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">W4 =</span> <span class="fu">mean</span>(W4, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_pop =</span> <span class="fu">mean</span>(log_pop, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">al_language2000 =</span> <span class="fu">mean</span>(al_language2000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">ps_original =</span> <span class="fu">median</span>(ps_original, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">al_religion2000 =</span> <span class="fu">mean</span>(al_religion2000, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fe_cultdiv =</span> <span class="fu">mean</span>(fe_cultdiv, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Expand the data to include different outcomes</span></span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a>expanded_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">replicate</span>(<span class="dv">5</span>, representative_data, <span class="at">simplify =</span> <span class="cn">FALSE</span>))</span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a>expanded_data<span class="sc">$</span>outcomes <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(outcome_levels, <span class="at">each =</span> <span class="dv">1</span>), <span class="at">levels =</span> outcome_levels)</span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-34"><a href="#cb139-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate survival curves based on the Cox model for m2</span></span>
<span id="cb139-35"><a href="#cb139-35" aria-hidden="true" tabindex="-1"></a>surv_fits_any <span class="ot">&lt;-</span> <span class="fu">survfit</span>(m2, <span class="at">newdata =</span> expanded_data)</span>
<span id="cb139-36"><a href="#cb139-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-37"><a href="#cb139-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors for the plot</span></span>
<span id="cb139-38"><a href="#cb139-38" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Peace Agreement"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Ceasefire"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"Gov Victory"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"Rebel Victory"</span> <span class="ot">=</span> <span class="st">"orange"</span>, <span class="st">"Actor Ceases"</span> <span class="ot">=</span> <span class="st">"cyan"</span>)</span>
<span id="cb139-39"><a href="#cb139-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-40"><a href="#cb139-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting survival curves for Any Recurrence</span></span>
<span id="cb139-41"><a href="#cb139-41" aria-hidden="true" tabindex="-1"></a>plot_any <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(</span>
<span id="cb139-42"><a href="#cb139-42" aria-hidden="true" tabindex="-1"></a>  surv_fits_any,</span>
<span id="cb139-43"><a href="#cb139-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> expanded_data,</span>
<span id="cb139-44"><a href="#cb139-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,  <span class="co"># Show p-value for log-rank test</span></span>
<span id="cb139-45"><a href="#cb139-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">FALSE</span>,  <span class="co"># Show confidence intervals</span></span>
<span id="cb139-46"><a href="#cb139-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Time in Days"</span>,</span>
<span id="cb139-47"><a href="#cb139-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>,</span>
<span id="cb139-48"><a href="#cb139-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb139-49"><a href="#cb139-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>),</span>
<span id="cb139-50"><a href="#cb139-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">break.time.by =</span> <span class="dv">1000</span>,</span>
<span id="cb139-51"><a href="#cb139-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,  <span class="co"># Show number at risk table</span></span>
<span id="cb139-52"><a href="#cb139-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">surv.scale =</span> <span class="st">"percent"</span>,</span>
<span id="cb139-53"><a href="#cb139-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="st">"Outcome"</span>,</span>
<span id="cb139-54"><a href="#cb139-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> <span class="fu">levels</span>(expanded_data<span class="sc">$</span>outcomes),  <span class="co"># Automatically use factor labels</span></span>
<span id="cb139-55"><a href="#cb139-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Survival Probability Over Time for War Recurrence Based on ACD Conflict ID"</span>,</span>
<span id="cb139-56"><a href="#cb139-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb139-57"><a href="#cb139-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb139-58"><a href="#cb139-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> colors,</span>
<span id="cb139-59"><a href="#cb139-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">1.2</span>,  <span class="co"># Increase line width for better visibility</span></span>
<span id="cb139-60"><a href="#cb139-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">linetype =</span> <span class="st">"solid"</span>  <span class="co"># Set line type to solid for all curves</span></span>
<span id="cb139-61"><a href="#cb139-61" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .pvalue(fit, data = data, method = method, pval = pval, pval.coord = pval.coord, : There are no survival curves to be compared. 
 This is a null model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in (function (survsummary, times, survtable = c("cumevents",
"risk.table", : The length of legend.labs should be 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the legend font size and axis titles for Any Recurrence plot</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>plot_any<span class="sc">$</span>plot <span class="ot">&lt;-</span> plot_any<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Increase legend text size</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),  <span class="co"># Increase legend title size</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># X-axis title size</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Y-axis title size</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),  <span class="co"># X-axis text size and rotation</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),   <span class="co"># Y-axis text size</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))    <span class="co"># Plot title size</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the risk table text for Any Recurrence plot</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>plot_any<span class="sc">$</span>table <span class="ot">&lt;-</span> plot_any<span class="sc">$</span>table <span class="sc">+</span></span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate risk table text</span></span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate survival curves based on the Cox model for m4</span></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>surv_fits_side <span class="ot">&lt;-</span> <span class="fu">survfit</span>(m4, <span class="at">newdata =</span> expanded_data)</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting survival curves for Side Recurrence</span></span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>plot_side <span class="ot">&lt;-</span> <span class="fu">ggsurvplot</span>(</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>  surv_fits_side,</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> expanded_data,</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,  <span class="co"># Show p-value for log-rank test</span></span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">FALSE</span>,  <span class="co"># Show confidence intervals</span></span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Time in Days"</span>,</span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>,</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>(),</span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20000</span>),</span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">break.time.by =</span> <span class="dv">1000</span>,</span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,  <span class="co"># Show number at risk table</span></span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">surv.scale =</span> <span class="st">"percent"</span>,</span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="st">"Outcome"</span>,</span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.labs =</span> <span class="fu">levels</span>(expanded_data<span class="sc">$</span>outcomes),  <span class="co"># Automatically use factor labels</span></span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Survival Probability Over Time for War Recurrence Based on Sufficient Linkage"</span>,</span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">""</span>,</span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">palette =</span> colors,</span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fl">1.2</span>,  <span class="co"># Increase line width for better visibility</span></span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">linetype =</span> <span class="st">"solid"</span>  <span class="co"># Set line type to solid for all curves</span></span>
<span id="cb143-39"><a href="#cb143-39" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .pvalue(fit, data = data, method = method, pval = pval, pval.coord = pval.coord, : There are no survival curves to be compared. 
 This is a null model.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in (function (survsummary, times, survtable = c("cumevents",
"risk.table", : The length of legend.labs should be 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the legend font size and axis titles for Side Recurrence plot</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>plot_side<span class="sc">$</span>plot <span class="ot">&lt;-</span> plot_side<span class="sc">$</span>plot <span class="sc">+</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),  <span class="co"># Increase legend text size</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),  <span class="co"># Increase legend title size</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># X-axis title size</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Y-axis title size</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),  <span class="co"># X-axis text size and rotation</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),   <span class="co"># Y-axis text size</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))    <span class="co"># Plot title size</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Customize the risk table text for Side Recurrence plot</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>plot_side<span class="sc">$</span>table <span class="ot">&lt;-</span> plot_side<span class="sc">$</span>table <span class="sc">+</span></span>
<span id="cb147-13"><a href="#cb147-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="co"># Rotate risk table text</span></span>
<span id="cb147-14"><a href="#cb147-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-15"><a href="#cb147-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plots</span></span>
<span id="cb147-16"><a href="#cb147-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_any)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.
No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(plot_side)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.
No shared levels found between `names(values)` of the manual scale and the
data's fill values.
No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's colour values.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: No shared levels found between `names(values)` of the manual scale and the
data's fill values.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rsf--var-im-any" class="level3">
<h3 class="anchored" data-anchor-id="rsf--var-im-any">RSF- Var Im-Any</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load necessary packages</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("randomForestSRC")</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("timeROC")</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("caret")</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForestSRC)</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pec)</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(timeROC)</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survivalROC)</span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'episodes' is already loaded</span></span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying labels</span></span>
<span id="cb156-19"><a href="#cb156-19" aria-hidden="true" tabindex="-1"></a>episodes_a <span class="ot">&lt;-</span> <span class="fu">apply_labels</span>(episodes, </span>
<span id="cb156-20"><a href="#cb156-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">time_to_recur_any =</span> <span class="st">"Time to Recur Any"</span>, </span>
<span id="cb156-21"><a href="#cb156-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">recur_any =</span> <span class="st">"War Recurrence Any"</span>,  </span>
<span id="cb156-22"><a href="#cb156-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dis =</span> <span class="st">"Actor Ceases"</span>, </span>
<span id="cb156-23"><a href="#cb156-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cease =</span> <span class="st">"Ceasefire"</span>, </span>
<span id="cb156-24"><a href="#cb156-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">govvic =</span> <span class="st">"Government Victory"</span>, </span>
<span id="cb156-25"><a href="#cb156-25" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rebvic =</span> <span class="st">"Rebel Victory"</span>, </span>
<span id="cb156-26"><a href="#cb156-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">lowac =</span> <span class="st">"Low Activity"</span>, </span>
<span id="cb156-27"><a href="#cb156-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">W4 =</span> <span class="st">"Coalition Size"</span>, </span>
<span id="cb156-28"><a href="#cb156-28" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pko_u =</span> <span class="st">"Peacekeeping Operations"</span>, </span>
<span id="cb156-29"><a href="#cb156-29" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_dur =</span> <span class="st">"Log Duration"</span>, </span>
<span id="cb156-30"><a href="#cb156-30" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cold_war =</span> <span class="st">"Cold War"</span>, </span>
<span id="cb156-31"><a href="#cb156-31" aria-hidden="true" tabindex="-1"></a>                           <span class="at">p_polity2 =</span> <span class="st">"Polity Score"</span>, </span>
<span id="cb156-32"><a href="#cb156-32" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fe_etfra =</span> <span class="st">"Ethnic Fractionalization"</span>, </span>
<span id="cb156-33"><a href="#cb156-33" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_gdp =</span> <span class="st">"Log GDP per Capita"</span>,</span>
<span id="cb156-34"><a href="#cb156-34" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_pop =</span> <span class="st">"Log Population"</span>,</span>
<span id="cb156-35"><a href="#cb156-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">al_language2000 =</span> <span class="st">"Language Fractionalization"</span>,</span>
<span id="cb156-36"><a href="#cb156-36" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ps_original =</span> <span class="st">"Power-Sharing"</span>,</span>
<span id="cb156-37"><a href="#cb156-37" aria-hidden="true" tabindex="-1"></a>                           <span class="at">al_religion2000 =</span> <span class="st">"Religion Fractionalization"</span>,</span>
<span id="cb156-38"><a href="#cb156-38" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fe_cultdiv =</span> <span class="st">"Cultural Diversity"</span>,</span>
<span id="cb156-39"><a href="#cb156-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">veto_u =</span> <span class="st">"Veto Players"</span>,</span>
<span id="cb156-40"><a href="#cb156-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">gov_war =</span> <span class="st">"War over Government"</span>,</span>
<span id="cb156-41"><a href="#cb156-41" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ter_war =</span> <span class="st">"War over Territory"</span>)</span>
<span id="cb156-42"><a href="#cb156-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-43"><a href="#cb156-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting data and removing lowac</span></span>
<span id="cb156-44"><a href="#cb156-44" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes_a, <span class="at">select =</span> <span class="fu">c</span>(time_to_recur_any, recur_any, dis, cease, govvic, rebvic, pko_u, log_dur, cold_war, log_gdp, veto_u, gov_war, ter_war, p_polity2, fe_etfra, W4, log_pop, al_language2000, ps_original, al_religion2000, fe_cultdiv))</span>
<span id="cb156-45"><a href="#cb156-45" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(X)</span>
<span id="cb156-46"><a href="#cb156-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-47"><a href="#cb156-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure numeric variables are correctly formatted</span></span>
<span id="cb156-48"><a href="#cb156-48" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span></span>
<span id="cb156-49"><a href="#cb156-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric))</span>
<span id="cb156-50"><a href="#cb156-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-51"><a href="#cb156-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cross-validation folds</span></span>
<span id="cb156-52"><a href="#cb156-52" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb156-53"><a href="#cb156-53" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(X<span class="sc">$</span>recur_any, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">list =</span> <span class="cn">TRUE</span>)</span>
<span id="cb156-54"><a href="#cb156-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-55"><a href="#cb156-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store variable importance scores</span></span>
<span id="cb156-56"><a href="#cb156-56" aria-hidden="true" tabindex="-1"></a>importance_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">length</span>(folds))</span>
<span id="cb156-57"><a href="#cb156-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-58"><a href="#cb156-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation</span></span>
<span id="cb156-59"><a href="#cb156-59" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(folds)) {</span>
<span id="cb156-60"><a href="#cb156-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define training and validation sets</span></span>
<span id="cb156-61"><a href="#cb156-61" aria-hidden="true" tabindex="-1"></a>  train_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[<span class="sc">-</span>i])</span>
<span id="cb156-62"><a href="#cb156-62" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[i])</span>
<span id="cb156-63"><a href="#cb156-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb156-64"><a href="#cb156-64" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> X[train_indices, ]</span>
<span id="cb156-65"><a href="#cb156-65" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> X[test_indices, ]</span>
<span id="cb156-66"><a href="#cb156-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb156-67"><a href="#cb156-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Train the Random Survival Forest model</span></span>
<span id="cb156-68"><a href="#cb156-68" aria-hidden="true" tabindex="-1"></a>  rsf <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any) <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">ntree =</span> <span class="dv">1000</span>, <span class="at">nodesize =</span> <span class="dv">5</span>, <span class="at">nsplit =</span> <span class="dv">50</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb156-69"><a href="#cb156-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb156-70"><a href="#cb156-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the variable importance scores</span></span>
<span id="cb156-71"><a href="#cb156-71" aria-hidden="true" tabindex="-1"></a>  importance_list[[i]] <span class="ot">&lt;-</span> rsf<span class="sc">$</span>importance</span>
<span id="cb156-72"><a href="#cb156-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb156-73"><a href="#cb156-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-74"><a href="#cb156-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate variable importance scores</span></span>
<span id="cb156-75"><a href="#cb156-75" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(cbind, importance_list))</span>
<span id="cb156-76"><a href="#cb156-76" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(importance_df)</span>
<span id="cb156-77"><a href="#cb156-77" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(importance_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb156-78"><a href="#cb156-78" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Importance <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(importance_df[, <span class="sc">-</span><span class="fu">ncol</span>(importance_df)])</span>
<span id="cb156-79"><a href="#cb156-79" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> importance_df[, <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Importance"</span>)]</span>
<span id="cb156-80"><a href="#cb156-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-81"><a href="#cb156-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Relabeling variables for plot</span></span>
<span id="cb156-82"><a href="#cb156-82" aria-hidden="true" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Actor Ceases"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Government Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Peacekeeping Operations"</span>, <span class="st">"Log Duration"</span>, <span class="st">"Cold War"</span>, <span class="st">"Log GDP per Capita"</span>, <span class="st">"Veto Players"</span>, <span class="st">"War over Government"</span>, <span class="st">"War over Territory"</span>, <span class="st">"Polity Score"</span>, <span class="st">"Ethnic Fractionalization"</span>, <span class="st">"Coalition Size"</span>, <span class="st">"Log Population"</span>, <span class="st">"Language Fractionalization"</span>, <span class="st">"Power-Sharing"</span>, <span class="st">"Religion Fractionalization"</span>, <span class="st">"Cultural Diversity"</span>)</span>
<span id="cb156-83"><a href="#cb156-83" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(var_labels) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dis"</span>, <span class="st">"cease"</span>, <span class="st">"govvic"</span>, <span class="st">"rebvic"</span>, <span class="st">"pko_u"</span>, <span class="st">"log_dur"</span>, <span class="st">"cold_war"</span>, <span class="st">"log_gdp"</span>, <span class="st">"veto_u"</span>, <span class="st">"gov_war"</span>, <span class="st">"ter_war"</span>, <span class="st">"p_polity2"</span>, <span class="st">"fe_etfra"</span>, <span class="st">"W4"</span>, <span class="st">"log_pop"</span>, <span class="st">"al_language2000"</span>, <span class="st">"ps_original"</span>, <span class="st">"al_religion2000"</span>, <span class="st">"fe_cultdiv"</span>)</span>
<span id="cb156-84"><a href="#cb156-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-85"><a href="#cb156-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding variable labels</span></span>
<span id="cb156-86"><a href="#cb156-86" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(importance_df<span class="sc">$</span>Variable, <span class="at">levels =</span> <span class="fu">names</span>(var_labels), <span class="at">labels =</span> var_labels[importance_df<span class="sc">$</span>Variable])</span>
<span id="cb156-87"><a href="#cb156-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-88"><a href="#cb156-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by importance</span></span>
<span id="cb156-89"><a href="#cb156-89" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> importance_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Importance))</span>
<span id="cb156-90"><a href="#cb156-90" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(importance_df<span class="sc">$</span>Variable, <span class="at">levels =</span> importance_df<span class="sc">$</span>Variable)</span>
<span id="cb156-91"><a href="#cb156-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-92"><a href="#cb156-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting using ggplot2</span></span>
<span id="cb156-93"><a href="#cb156-93" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(importance_df, <span class="fu">aes</span>(<span class="at">x =</span> Importance, <span class="at">y =</span> Variable)) <span class="sc">+</span></span>
<span id="cb156-94"><a href="#cb156-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb156-95"><a href="#cb156-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb156-96"><a href="#cb156-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variable Importance Based on ACD Conflict ID"</span>, <span class="at">x =</span> <span class="st">"Variable Importance"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb156-97"><a href="#cb156-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rsf---var-im---link" class="level3">
<h3 class="anchored" data-anchor-id="rsf---var-im---link">RSF - Var Im - Link</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load necessary packages</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("randomForestSRC")</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("timeROC")</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("caret")</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForestSRC)</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pec)</span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(timeROC)</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survivalROC)</span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(expss)</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'episodes' is already loaded</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Applying labels</span></span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a>episodes_a <span class="ot">&lt;-</span> <span class="fu">apply_labels</span>(episodes, </span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>                           <span class="at">time_to_recur =</span> <span class="st">"Time to Recur"</span>, </span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a>                           <span class="at">recur_any =</span> <span class="st">"War Recurrence"</span>,  </span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dis =</span> <span class="st">"Actor Ceases"</span>, </span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cease =</span> <span class="st">"Ceasefire"</span>, </span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a>                           <span class="at">govvic =</span> <span class="st">"Government Victory"</span>, </span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rebvic =</span> <span class="st">"Rebel Victory"</span>, </span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">W4 =</span> <span class="st">"Coalition Size"</span>, </span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pko_u =</span> <span class="st">"Peacekeeping Operations"</span>, </span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_dur =</span> <span class="st">"Log Duration"</span>, </span>
<span id="cb157-29"><a href="#cb157-29" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cold_war =</span> <span class="st">"Cold War"</span>, </span>
<span id="cb157-30"><a href="#cb157-30" aria-hidden="true" tabindex="-1"></a>                           <span class="at">p_polity2 =</span> <span class="st">"Polity Score"</span>, </span>
<span id="cb157-31"><a href="#cb157-31" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fe_etfra =</span> <span class="st">"Ethnic Fractionalization"</span>, </span>
<span id="cb157-32"><a href="#cb157-32" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_gdp =</span> <span class="st">"Log GDP per Capita"</span>,</span>
<span id="cb157-33"><a href="#cb157-33" aria-hidden="true" tabindex="-1"></a>                           <span class="at">log_pop =</span> <span class="st">"Log Population"</span>,</span>
<span id="cb157-34"><a href="#cb157-34" aria-hidden="true" tabindex="-1"></a>                           <span class="at">al_language2000 =</span> <span class="st">"Language Fractionalization"</span>,</span>
<span id="cb157-35"><a href="#cb157-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ps_original =</span> <span class="st">"Power-Sharing"</span>,</span>
<span id="cb157-36"><a href="#cb157-36" aria-hidden="true" tabindex="-1"></a>                           <span class="at">al_religion2000 =</span> <span class="st">"Religion Fractionalization"</span>,</span>
<span id="cb157-37"><a href="#cb157-37" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fe_cultdiv =</span> <span class="st">"Cultural Diversity"</span>,</span>
<span id="cb157-38"><a href="#cb157-38" aria-hidden="true" tabindex="-1"></a>                           <span class="at">veto_u =</span> <span class="st">"Veto Players"</span>,</span>
<span id="cb157-39"><a href="#cb157-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">gov_war =</span> <span class="st">"War over Government"</span>,</span>
<span id="cb157-40"><a href="#cb157-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">ter_war =</span> <span class="st">"War over Territory"</span>)</span>
<span id="cb157-41"><a href="#cb157-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-42"><a href="#cb157-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting data</span></span>
<span id="cb157-43"><a href="#cb157-43" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes_a, <span class="at">select =</span> <span class="fu">c</span>(time_to_recur, recur_any, dis, cease, govvic, rebvic, pko_u, log_dur, cold_war, log_gdp, veto_u, gov_war, ter_war, p_polity2, fe_etfra, W4, log_pop, al_language2000, ps_original, al_religion2000, fe_cultdiv))</span>
<span id="cb157-44"><a href="#cb157-44" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(X)</span>
<span id="cb157-45"><a href="#cb157-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-46"><a href="#cb157-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure numeric variables are correctly formatted</span></span>
<span id="cb157-47"><a href="#cb157-47" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span></span>
<span id="cb157-48"><a href="#cb157-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric))</span>
<span id="cb157-49"><a href="#cb157-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-50"><a href="#cb157-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cross-validation folds</span></span>
<span id="cb157-51"><a href="#cb157-51" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># For reproducibility</span></span>
<span id="cb157-52"><a href="#cb157-52" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(X<span class="sc">$</span>recur_any, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">list =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-53"><a href="#cb157-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-54"><a href="#cb157-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a list to store variable importance scores</span></span>
<span id="cb157-55"><a href="#cb157-55" aria-hidden="true" tabindex="-1"></a>importance_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">length</span>(folds))</span>
<span id="cb157-56"><a href="#cb157-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-57"><a href="#cb157-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform cross-validation</span></span>
<span id="cb157-58"><a href="#cb157-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(folds)) {</span>
<span id="cb157-59"><a href="#cb157-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define training and validation sets</span></span>
<span id="cb157-60"><a href="#cb157-60" aria-hidden="true" tabindex="-1"></a>  train_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[<span class="sc">-</span>i])</span>
<span id="cb157-61"><a href="#cb157-61" aria-hidden="true" tabindex="-1"></a>  test_indices <span class="ot">&lt;-</span> <span class="fu">unlist</span>(folds[i])</span>
<span id="cb157-62"><a href="#cb157-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-63"><a href="#cb157-63" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> X[train_indices, ]</span>
<span id="cb157-64"><a href="#cb157-64" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> X[test_indices, ]</span>
<span id="cb157-65"><a href="#cb157-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-66"><a href="#cb157-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Train the Random Survival Forest model</span></span>
<span id="cb157-67"><a href="#cb157-67" aria-hidden="true" tabindex="-1"></a>  rsf <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(time_to_recur, recur_any) <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">ntree =</span> <span class="dv">1000</span>, <span class="at">nodesize =</span> <span class="dv">5</span>, <span class="at">nsplit =</span> <span class="dv">50</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-68"><a href="#cb157-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb157-69"><a href="#cb157-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the variable importance scores</span></span>
<span id="cb157-70"><a href="#cb157-70" aria-hidden="true" tabindex="-1"></a>  importance_list[[i]] <span class="ot">&lt;-</span> rsf<span class="sc">$</span>importance</span>
<span id="cb157-71"><a href="#cb157-71" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb157-72"><a href="#cb157-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-73"><a href="#cb157-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate variable importance scores</span></span>
<span id="cb157-74"><a href="#cb157-74" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(cbind, importance_list))</span>
<span id="cb157-75"><a href="#cb157-75" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">rownames</span>(importance_df)</span>
<span id="cb157-76"><a href="#cb157-76" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(importance_df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb157-77"><a href="#cb157-77" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Importance <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(importance_df[, <span class="sc">-</span><span class="fu">ncol</span>(importance_df)])</span>
<span id="cb157-78"><a href="#cb157-78" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> importance_df[, <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Importance"</span>)]</span>
<span id="cb157-79"><a href="#cb157-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-80"><a href="#cb157-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Relabeling variables for plot</span></span>
<span id="cb157-81"><a href="#cb157-81" aria-hidden="true" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Actor Ceases"</span>, <span class="st">"Ceasefire"</span>, <span class="st">"Government Victory"</span>, <span class="st">"Rebel Victory"</span>, <span class="st">"Peacekeeping Operations"</span>, <span class="st">"Log Duration"</span>, <span class="st">"Cold War"</span>, <span class="st">"Log GDP per Capita"</span>, <span class="st">"Veto Players"</span>, <span class="st">"War over Government"</span>, <span class="st">"War over Territory"</span>, <span class="st">"Polity Score"</span>, <span class="st">"Ethnic Fractionalization"</span>, <span class="st">"Coalition Size"</span>, <span class="st">"Log Population"</span>, <span class="st">"Language Fractionalization"</span>, <span class="st">"Power-Sharing"</span>, <span class="st">"Religion Fractionalization"</span>, <span class="st">"Cultural Diversity"</span>)</span>
<span id="cb157-82"><a href="#cb157-82" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(var_labels) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dis"</span>, <span class="st">"cease"</span>, <span class="st">"govvic"</span>, <span class="st">"rebvic"</span>, <span class="st">"pko_u"</span>, <span class="st">"log_dur"</span>, <span class="st">"cold_war"</span>, <span class="st">"log_gdp"</span>, <span class="st">"veto_u"</span>, <span class="st">"gov_war"</span>, <span class="st">"ter_war"</span>, <span class="st">"p_polity2"</span>, <span class="st">"fe_etfra"</span>, <span class="st">"W4"</span>, <span class="st">"log_pop"</span>, <span class="st">"al_language2000"</span>, <span class="st">"ps_original"</span>, <span class="st">"al_religion2000"</span>, <span class="st">"fe_cultdiv"</span>)</span>
<span id="cb157-83"><a href="#cb157-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-84"><a href="#cb157-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding variable labels</span></span>
<span id="cb157-85"><a href="#cb157-85" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(importance_df<span class="sc">$</span>Variable, <span class="at">levels =</span> <span class="fu">names</span>(var_labels), <span class="at">labels =</span> var_labels[importance_df<span class="sc">$</span>Variable])</span>
<span id="cb157-86"><a href="#cb157-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-87"><a href="#cb157-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Order by importance</span></span>
<span id="cb157-88"><a href="#cb157-88" aria-hidden="true" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> importance_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Importance))</span>
<span id="cb157-89"><a href="#cb157-89" aria-hidden="true" tabindex="-1"></a>importance_df<span class="sc">$</span>Variable <span class="ot">&lt;-</span> <span class="fu">factor</span>(importance_df<span class="sc">$</span>Variable, <span class="at">levels =</span> importance_df<span class="sc">$</span>Variable)</span>
<span id="cb157-90"><a href="#cb157-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-91"><a href="#cb157-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting using ggplot2</span></span>
<span id="cb157-92"><a href="#cb157-92" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(importance_df, <span class="fu">aes</span>(<span class="at">x =</span> Importance, <span class="at">y =</span> Variable)) <span class="sc">+</span></span>
<span id="cb157-93"><a href="#cb157-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb157-94"><a href="#cb157-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb157-95"><a href="#cb157-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Variable Importance Based on Linkage"</span>, <span class="at">x =</span> <span class="st">"Variable Importance"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb157-96"><a href="#cb157-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rsf--sur-probs---any" class="level3">
<h3 class="anchored" data-anchor-id="rsf--sur-probs---any">RSF -Sur Probs - Any</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load necessary packages</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("randomForestSRC")</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggplot2")</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForestSRC)</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'episodes' is your dataset</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting and cleaning data</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, <span class="at">select =</span> <span class="fu">c</span>(time_to_recur_any, recur_any, dis, cease, govvic, rebvic, peace, W4, pko_u, log_dur, </span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>                                   cold_war, p_polity2, fe_etfra, log_gdp, log_pop, al_language2000, ps_original, </span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>                                   al_religion2000, fe_cultdiv, veto_u, gov_war, ter_war))</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(X)</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric))</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the Random Survival Forest model on the entire dataset</span></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(time_to_recur_any, recur_any) <span class="sc">~</span> ., <span class="at">data =</span> X, <span class="at">ntree =</span> <span class="dv">1000</span>, <span class="at">nodesize =</span> <span class="dv">5</span>, <span class="at">nsplit =</span> <span class="dv">50</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict survival probabilities for the entire dataset</span></span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, X, <span class="at">OOB =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>survival_probs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred<span class="sc">$</span>survival)</span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract time points</span></span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>time_points <span class="ot">&lt;-</span> fit<span class="sc">$</span>time.interest</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(survival_probs) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Time"</span>, time_points, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>survival_probs<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(survival_probs)</span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a>X<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)</span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-31"><a href="#cb158-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert survival probabilities to long format for plotting</span></span>
<span id="cb158-32"><a href="#cb158-32" aria-hidden="true" tabindex="-1"></a>survival_probs_long <span class="ot">&lt;-</span> survival_probs <span class="sc">%&gt;%</span></span>
<span id="cb158-33"><a href="#cb158-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>id, <span class="at">names_to =</span> <span class="st">"Time"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-34"><a href="#cb158-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"Time_"</span>, <span class="st">""</span>, Time)))</span>
<span id="cb158-35"><a href="#cb158-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-36"><a href="#cb158-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with the original data to get the binary outcome variables</span></span>
<span id="cb158-37"><a href="#cb158-37" aria-hidden="true" tabindex="-1"></a>survival_probs_long <span class="ot">&lt;-</span> <span class="fu">left_join</span>(survival_probs_long, X, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb158-38"><a href="#cb158-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-39"><a href="#cb158-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate mean and confidence intervals</span></span>
<span id="cb158-40"><a href="#cb158-40" aria-hidden="true" tabindex="-1"></a>calculate_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb158-41"><a href="#cb158-41" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb158-42"><a href="#cb158-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb158-43"><a href="#cb158-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb158-44"><a href="#cb158-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Probability =</span> <span class="fu">mean</span>(Probability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb158-45"><a href="#cb158-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> <span class="fu">sd</span>(Probability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb158-46"><a href="#cb158-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">Lower_CI =</span> Mean_Probability <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(Probability)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(Probability)),</span>
<span id="cb158-47"><a href="#cb158-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">Upper_CI =</span> Mean_Probability <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(Probability)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(Probability))</span>
<span id="cb158-48"><a href="#cb158-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb158-49"><a href="#cb158-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-50"><a href="#cb158-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-51"><a href="#cb158-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for each binary outcome variable</span></span>
<span id="cb158-52"><a href="#cb158-52" aria-hidden="true" tabindex="-1"></a>dis_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, dis <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb158-53"><a href="#cb158-53" aria-hidden="true" tabindex="-1"></a>cease_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, cease <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb158-54"><a href="#cb158-54" aria-hidden="true" tabindex="-1"></a>govvic_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, govvic <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb158-55"><a href="#cb158-55" aria-hidden="true" tabindex="-1"></a>rebvic_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, rebvic <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb158-56"><a href="#cb158-56" aria-hidden="true" tabindex="-1"></a>peace_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, peace <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb158-57"><a href="#cb158-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-58"><a href="#cb158-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot using ggplot2, one line per variable of interest with confidence intervals</span></span>
<span id="cb158-59"><a href="#cb158-59" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb158-60"><a href="#cb158-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dis_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Disappearance"</span>)) <span class="sc">+</span></span>
<span id="cb158-61"><a href="#cb158-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> dis_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Disappearance"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb158-62"><a href="#cb158-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cease_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Ceasefire"</span>)) <span class="sc">+</span></span>
<span id="cb158-63"><a href="#cb158-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> cease_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Ceasefire"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb158-64"><a href="#cb158-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> govvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Government Victory"</span>)) <span class="sc">+</span></span>
<span id="cb158-65"><a href="#cb158-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> govvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Government Victory"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb158-66"><a href="#cb158-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> rebvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Rebel Victory"</span>)) <span class="sc">+</span></span>
<span id="cb158-67"><a href="#cb158-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> rebvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Rebel Victory"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb158-68"><a href="#cb158-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> peace_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Peace Agreement"</span>)) <span class="sc">+</span></span>
<span id="cb158-69"><a href="#cb158-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> peace_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Peace Agreement"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb158-70"><a href="#cb158-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Survival Probabilities Over Time(Any)"</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Survival Probability"</span>, <span class="at">color =</span> <span class="st">"Variable"</span>, <span class="at">fill =</span> <span class="st">"Variable"</span>) <span class="sc">+</span></span>
<span id="cb158-71"><a href="#cb158-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb158-72"><a href="#cb158-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rsf---sur-probs--side" class="level3">
<h3 class="anchored" data-anchor-id="rsf---sur-probs--side">RSF - Sur Probs- Side</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load necessary packages</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("randomForestSRC")</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("ggplot2")</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForestSRC)</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'episodes' is your dataset</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting and cleaning data</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, <span class="at">select =</span> <span class="fu">c</span>(time_to_recur, recur_side, dis, cease, govvic, rebvic, peace, W4, pko_u, log_dur, </span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>                                   cold_war, p_polity2, fe_etfra, log_gdp, log_pop, al_language2000, ps_original, </span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>                                   al_religion2000, fe_cultdiv, veto_u, gov_war, ter_war))</span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(X)</span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> X <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric))</span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the Random Survival Forest model on the entire dataset</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rfsrc</span>(<span class="fu">Surv</span>(time_to_recur, recur_side) <span class="sc">~</span> ., <span class="at">data =</span> X, <span class="at">ntree =</span> <span class="dv">1000</span>, <span class="at">nodesize =</span> <span class="dv">5</span>, <span class="at">nsplit =</span> <span class="dv">50</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict survival probabilities for the entire dataset</span></span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, X, <span class="at">OOB =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>survival_probs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred<span class="sc">$</span>survival)</span>
<span id="cb159-24"><a href="#cb159-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-25"><a href="#cb159-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract time points</span></span>
<span id="cb159-26"><a href="#cb159-26" aria-hidden="true" tabindex="-1"></a>time_points <span class="ot">&lt;-</span> fit<span class="sc">$</span>time.interest</span>
<span id="cb159-27"><a href="#cb159-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(survival_probs) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Time"</span>, time_points, <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb159-28"><a href="#cb159-28" aria-hidden="true" tabindex="-1"></a>survival_probs<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(survival_probs)</span>
<span id="cb159-29"><a href="#cb159-29" aria-hidden="true" tabindex="-1"></a>X<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)</span>
<span id="cb159-30"><a href="#cb159-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-31"><a href="#cb159-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert survival probabilities to long format for plotting</span></span>
<span id="cb159-32"><a href="#cb159-32" aria-hidden="true" tabindex="-1"></a>survival_probs_long <span class="ot">&lt;-</span> survival_probs <span class="sc">%&gt;%</span></span>
<span id="cb159-33"><a href="#cb159-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>id, <span class="at">names_to =</span> <span class="st">"Time"</span>, <span class="at">values_to =</span> <span class="st">"Probability"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-34"><a href="#cb159-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">"Time_"</span>, <span class="st">""</span>, Time)))</span>
<span id="cb159-35"><a href="#cb159-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-36"><a href="#cb159-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with the original data to get the binary outcome variables</span></span>
<span id="cb159-37"><a href="#cb159-37" aria-hidden="true" tabindex="-1"></a>survival_probs_long <span class="ot">&lt;-</span> <span class="fu">left_join</span>(survival_probs_long, X, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb159-38"><a href="#cb159-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-39"><a href="#cb159-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate mean and confidence intervals</span></span>
<span id="cb159-40"><a href="#cb159-40" aria-hidden="true" tabindex="-1"></a>calculate_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb159-41"><a href="#cb159-41" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb159-42"><a href="#cb159-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Time) <span class="sc">%&gt;%</span></span>
<span id="cb159-43"><a href="#cb159-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb159-44"><a href="#cb159-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">Mean_Probability =</span> <span class="fu">mean</span>(Probability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb159-45"><a href="#cb159-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">SD =</span> <span class="fu">sd</span>(Probability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb159-46"><a href="#cb159-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">Lower_CI =</span> Mean_Probability <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(Probability)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(Probability)),</span>
<span id="cb159-47"><a href="#cb159-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">Upper_CI =</span> Mean_Probability <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="fu">length</span>(Probability)<span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(Probability))</span>
<span id="cb159-48"><a href="#cb159-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb159-49"><a href="#cb159-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-50"><a href="#cb159-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-51"><a href="#cb159-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate summary statistics for each binary outcome variable</span></span>
<span id="cb159-52"><a href="#cb159-52" aria-hidden="true" tabindex="-1"></a>dis_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, dis <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb159-53"><a href="#cb159-53" aria-hidden="true" tabindex="-1"></a>cease_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, cease <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb159-54"><a href="#cb159-54" aria-hidden="true" tabindex="-1"></a>govvic_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, govvic <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb159-55"><a href="#cb159-55" aria-hidden="true" tabindex="-1"></a>rebvic_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, rebvic <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb159-56"><a href="#cb159-56" aria-hidden="true" tabindex="-1"></a>peace_summary <span class="ot">&lt;-</span> <span class="fu">calculate_summary</span>(<span class="fu">filter</span>(survival_probs_long, peace <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb159-57"><a href="#cb159-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-58"><a href="#cb159-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot using ggplot2, one line per variable of interest with confidence intervals</span></span>
<span id="cb159-59"><a href="#cb159-59" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb159-60"><a href="#cb159-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dis_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Actor Ceases"</span>)) <span class="sc">+</span></span>
<span id="cb159-61"><a href="#cb159-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> dis_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Actor Ceases"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb159-62"><a href="#cb159-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> cease_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Ceasefire"</span>)) <span class="sc">+</span></span>
<span id="cb159-63"><a href="#cb159-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> cease_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Ceasefire"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb159-64"><a href="#cb159-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> govvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Government Victory"</span>)) <span class="sc">+</span></span>
<span id="cb159-65"><a href="#cb159-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> govvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Government Victory"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb159-66"><a href="#cb159-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> rebvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Rebel Victory"</span>)) <span class="sc">+</span></span>
<span id="cb159-67"><a href="#cb159-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> rebvic_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Rebel Victory"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb159-68"><a href="#cb159-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> peace_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">y =</span> Mean_Probability, <span class="at">color =</span> <span class="st">"Peace Agreement"</span>)) <span class="sc">+</span></span>
<span id="cb159-69"><a href="#cb159-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> peace_summary, <span class="fu">aes</span>(<span class="at">x =</span> Time, <span class="at">ymin =</span> Lower_CI, <span class="at">ymax =</span> Upper_CI, <span class="at">fill =</span> <span class="st">"Peace Agreement"</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb159-70"><a href="#cb159-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Survival Probabilities Over Time(Sidde)"</span>, <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">"Survival Probability"</span>, <span class="at">color =</span> <span class="st">"Variable"</span>, <span class="at">fill =</span> <span class="st">"Variable"</span>) <span class="sc">+</span></span>
<span id="cb159-71"><a href="#cb159-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb159-72"><a href="#cb159-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="War_Recur_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="causal-identification" class="level2">
<h2 class="anchored" data-anchor-id="causal-identification">Causal Identification</h2>
<section id="synthetic-control" class="level3">
<h3 class="anchored" data-anchor-id="synthetic-control">Synthetic Control</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset with only the relevant variables</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>episodes_control <span class="ot">&lt;-</span> <span class="fu">subset</span>(episodes, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"episode_id"</span>, <span class="st">"year"</span>, <span class="st">"recur_any"</span>, </span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"log_gdp"</span>, <span class="st">"log_pop"</span>, <span class="st">"p_polity2"</span>, </span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"fe_etfra"</span>, <span class="st">"log_dur"</span>, <span class="st">"cease"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>episodes_control <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(episodes_control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the structure of the dataset</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(episodes_control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [184 × 9] (S3: tbl_df/tbl/data.frame)
 $ episode_id: num [1:184] 4 17 18 27 31 34 40 48 51 59 ...
 $ year      : num [1:184] 1968 1996 1998 1990 2012 ...
 $ recur_any : num [1:184] 0 1 1 0 1 1 1 0 1 1 ...
 $ log_gdp   : num [1:184] 5.28 7.2 6.91 7.27 7.06 ...
 $ log_pop   : num [1:184] 15.3 18.1 18.1 15.2 17.7 ...
 $ p_polity2 : num [1:184] -4 8 8 2 -3 -4 -6 -5 8 -5 ...
 $ fe_etfra  : num [1:184] 0.743 0.161 0.161 0.132 0.522 ...
 $ log_dur   : num [1:184] 5.29 9.16 3.61 0 8.37 ...
 $ cease     : num [1:184] 0 1 1 0 1 0 0 0 0 1 ...
 - attr(*, "na.action")= 'omit' Named int [1:70] 1 2 3 5 6 7 8 9 12 13 ...
  ..- attr(*, "names")= chr [1:70] "1" "2" "3" "5" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for missing values again to ensure they've been removed</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(episodes_control))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="matching" class="level3">
<h3 class="anchored" data-anchor-id="matching">Matching</h3>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>